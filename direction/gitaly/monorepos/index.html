<!DOCTYPE html>
<html lang=en>
<head>
<meta charset=UTF-8 />
<meta content='width=device-width, initial-scale=1.0' name=viewport />
<meta content='default-src &#39;self&#39; https: http:; script-src &#39;self&#39; &#39;unsafe-inline&#39; &#39;unsafe-eval&#39; https: http:; style-src &#39;self&#39; &#39;unsafe-inline&#39; https: http:; object-src https: http:; base-uri &#39;self&#39;; connect-src &#39;self&#39; https: http: wss: ws:; frame-src &#39;self&#39; https: http:; img-src &#39;self&#39; https: http: data:; manifest-src &#39;self&#39;; media-src &#39;self&#39; https: http:; worker-src &#39;self&#39; https: http:;' http-equiv=Content-Security-Policy />
<meta content='index, follow' name=robots />
<title>
Product Direction - Monorepos
|
GitLab
</title>
<meta content='GitLab want to improve the monorepo experience. Learn more here!' name=description />
<meta content='GitLab want to improve the monorepo experience. Learn more here!' name='twitter:description'/>
<meta content='GitLab want to improve the monorepo experience. Learn more here!' property='og:description'/>
<meta content=GitLab property='og:site_name'/>
<meta content='Product Direction - Monorepos' property='og:title'/>
<meta content='https://gitlab.com/gitlab-com/www-gitlab-com/' property='og:repo'/>
<meta content='https://gitlab.com/' property='og:instance'/>
<meta content='gitlab-com/www-gitlab-com/' property='og:path'/>
<meta content='direction/gitaly/monorepos/index.html.md' property='og:relative_path'/>
<meta content='' property='og:monorepo_site_path_fragment'/>
<meta content=article property='og:type'/>
<meta content='https://about.gitlab.com/direction/gitaly/monorepos/' property='og:url'/>
<meta content="https://about.gitlab.com/images/opengraph/gitlab-blog-cover.png" property="og:image">
<meta content="https://about.gitlab.com/images/opengraph/gitlab-blog-cover.png" name="twitter:image">
<meta content=summary_large_image name='twitter:card'/>
<meta content='@GitLab' name='twitter:site'/>
<meta content='Product Direction - Monorepos' name='twitter:title'/>
<meta content='@GitLab' name='twitter:creator'/>
<link href='/atom.xml' rel=alternate title=Blog type='application/atom+xml'/>
<link href='/all-releases.xml' rel=alternate title='All Releases' type='application/atom+xml'/>
<link href='/security-releases.xml' rel=alternate title='Security Releases' type='application/atom+xml'/>
<link href='/releases.xml' rel=alternate title='Major Releases' type='application/atom+xml'/>
<link href='/ico/handbook/favicon.ico?cache=2022041' rel='shortcut icon'/>
<link href='/ico/handbook/favicon-192x192.png?cache=2022041' rel=icon sizes=192x192 type='image/png'/>
<link href='/ico/handbook/favicon-160x160.png?cache=2022041' rel=icon sizes=160x160 type='image/png'/>
<link href='/ico/handbook/favicon-96x96.png?cache=2022041' rel=icon sizes=96x96 type='image/png'/>
<link href='/ico/handbook/favicon-16x16.png?cache=2022041' rel=icon sizes=16x16 type='image/png'/>
<link href='/ico/handbook/favicon-32x32.png?cache=2022041' rel=icon sizes=32x32 type='image/png'/>
<link href='/ico/apple-touch-icon-57x57.png?cache=2022041' rel=apple-touch-icon sizes=57x57 />
<link href='/ico/apple-touch-icon-114x114.png?cache=2022041' rel=apple-touch-icon sizes=114x114 />
<link href='/ico/apple-touch-icon-72x72.png?cache=2022041' rel=apple-touch-icon sizes=72x72 />
<link href='/ico/apple-touch-icon-144x144.png?cache=2022041' rel=apple-touch-icon sizes=144x144 />
<link href='/ico/apple-touch-icon-60x60.png?cache=2022041' rel=apple-touch-icon sizes=60x60 />
<link href='/ico/apple-touch-icon-120x120.png?cache=2022041' rel=apple-touch-icon sizes=120x120 />
<link href='/ico/apple-touch-icon-76x76.png?cache=2022041' rel=apple-touch-icon sizes=76x76 />
<link href='/ico/apple-touch-icon-152x152.png?cache=2022041' rel=apple-touch-icon sizes=152x152 />
<link href='/ico/apple-touch-icon-180x180.png?cache=2022041' rel=apple-touch-icon sizes=180x180 />
<meta content='#554488' name=msapplication-TileColor />
<meta content='/ico/mstile-144x144.png?cache=2022041' name=msapplication-TileImage />
<meta content='/ico/browserconfig.xml' name=msapplication-config />
<script src='https://cdn.cookielaw.org/consent/7f944245-c5cd-4eed-a90e-dd955adfdd08/OtAutoBlock.js'></script>
<script charset=UTF-8 data-domain-script=7f944245-c5cd-4eed-a90e-dd955adfdd08 src='https://cdn.cookielaw.org/scripttemplates/otSDKStub.js'></script>
<script>
  //<![CDATA[
    function OptanonWrapper() { }
  //]]>
</script>
<script async=false defer=false id=mermaidscriptsource src='/javascripts/libs/mermaid.min.js?cacheBust=4cf1fb774d1'></script>
<script>
  //<![CDATA[
    window.dataLayer = window.dataLayer || []
    function gtag(){dataLayer.push(arguments);}
    gtag('consent', 'default', {
      'analytics_storage': 'denied',
      'ad_storage': 'denied',
      'functionality_storage': 'denied',
      'region': [ 'AT', 'BE', 'BG', 'HR', 'CY', 'CZ', 'DK', 'EE', 'FI', 'FR', 'DE', 'GR', 'HU', 'IE', 'IT', 'LV', 'LT', 'LU', 'MT', 'NL', 'PL', 'PT', 'RO', 'SK', 'SI', 'ES', 'SE', 'IS', 'LI', 'NO', 'GB', 'PE', 'RU'],
      'wait_for_update': 500
    });
    gtag('consent', 'default', {
      'analytics_storage': 'granted',
      'ad_storage': 'granted',
      'functionality_storage': 'granted',
      'wait_for_update': 500
    });
    
    window.geofeed = (options) => {
      dataLayer.push({
        'event' : 'OneTrustCountryLoad',
        'oneTrustCountryId': options.country.toString()
      })
    }
    
    const json = document.createElement('script');
    json.setAttribute('src', 'https://geolocation.onetrust.com/cookieconsentpub/v1/geo/location/geofeed');
    document.head.appendChild(json);
  //]]>
</script>
<script>document.documentElement.className = 'html--js'</script>
<script async='' src='//cdn.bizible.com/scripts/bizible.js'></script>
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-37019925-1', 'auto', {allowLinker: true});
ga('require', 'GTM-WC3ZR2P');
</script>
<script>
(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NJXWQL');
</script>
<script>
(function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
(w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
})(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');
_st('install','Z4n7msKyctXXfJs66EKx','2.0.0');
</script>
<link href='https://about.gitlab.com/direction/gitaly/monorepos/' rel=canonical />
<link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,500,600,700' rel=stylesheet />
<link crossorigin=anonymous href='https://use.fontawesome.com/releases/v5.1.0/css/all.css' integrity='sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt' rel=stylesheet />
<link href='https://cdnjs.cloudflare.com/ajax/libs/tiny-slider/2.8.7/tiny-slider.css' rel=stylesheet />
<link href="/stylesheets/styles.css" rel=stylesheet /><link href="/stylesheets/highlight.css" rel=stylesheet />

<link href="/stylesheets/highlight-tooltip.css?cacheBust=4cf1fb774d1" rel=stylesheet />
<link href="/stylesheets/slippers.css?cacheBust=4cf1fb774d1" rel=stylesheet />
<link href="/stylesheets/be-navigation.css?cacheBust=4cf1fb774d1" rel=stylesheet />
<link href="/stylesheets/handbook.css" rel=stylesheet />
<link href="/stylesheets/navigation-helpers.css" rel=stylesheet />
</head>
<body data-spy=scroll data-target='.qnav'>
<noscript>
<iframe height=0 src='//www.googletagmanager.com/ns.html?id=GTM-NJXWQL' style='display:none;visibility:hidden' width=0></iframe>
</noscript>
<template id=be-nav>
<div id=be-nav-target>
<slp-navigation></slp-navigation>
</div>
</template>
<nav class='slp-sticky slp-left-0 slp-right-0 slp-top-0 slp-bg-white slp-z-90' id=global-nav style='z-index: 1000000;'>
<be-navigation></be-navigation>
</nav>
<div class='search-box js-search-box'>
<i class='fa fa-search search-box-icon'></i>
<input class='search-input js-search st-header' placeholder='Search...'/>
<button aria-label='Close search' class='search-close js-search-toggle' type=button>
<i class='fa fa-times'></i>
</button>
</div>
<script src='/javascripts/be-navigation.js?cacheBust=4cf1fb774d1'></script>
<div class=blank-header>
<img src="/images/home/icons-pattern-left.svg" class="image-border image-border-left" alt="Gitlab hero border pattern left svg"/>
<img src="/images/home/icons-pattern-right.svg" class="image-border image-border-right" alt="Gitlab hero border pattern right svg"/>
<div class=header-content>
<h1>
Product Direction - Monorepos
</h1>
</div>
</div>
<div id=highlight-tooltip role=tooltip>
<a class="highlight-tooltip-link highlight-tooltip-link-tweet" href="#" target=_blank>
<i class="fab fa-twitter"></i>
<span class=sr-only>Share on Twitter</span>
</a>
<a class="highlight-tooltip-link highlight-tooltip-link-edit" href="#" target=_blank>
<i class="fab fa-gitlab"></i>
<span class=sr-only>Edit this page</span>
</a>
<a class="highlight-tooltip-link highlight-tooltip-link-web-ide" href="#" target=_blank>
<i class="fas fa-pen"></i>
<span class=sr-only>Open Web IDE</span>
</a>
<div id=highlight-tooltip-arrow data-popper-arrow></div>
</div>
<div class='wrapper sidebar-layout-wrapper clearfix'>
<aside class=tocs-sidebar>
<div class=codeowners>
<div>
<h4 class=codeowners-header>
Maintained by<span class='hidden-md hidden-lg'>:</span></h4>
</div>
<div class=codeowners-list>
<a class=codeowner href='https://gitlab.com/joshlambert'>
<img
src='/images/team/joshua.png'
class=codeowner-avatar-img
alt='Joshua Lambert'
title='Joshua Lambert'
>
</a>
<a class=codeowner href='https://gitlab.com/mjwood'>
<img
src='/images/team/markwood.jpg'
class=codeowner-avatar-img
alt='Mark Wood'
title='Mark Wood'
>
</a>
</div>
</div>
<h5>
Contribute to this page
</h5>
<div>
<a href="https://gitlab.com/-/ide/project/gitlab-com/www-gitlab-com/edit/master/-/source/direction/gitaly/monorepos/index.html.md" class=external-source-link>Edit this page</a>
<div class='d-flex align-items-center mt-2'></div>
</div>
</aside>
<div class='container md-page'>
<ol class=breadcrumb>
<li class=meta-signage-header>You are here:</li>
<li><a href="/direction/">GitLab Direction</a></li><li><a href="/direction/gitaly/">Category Direction - Gitaly</a></li><li>Product Direction - Monorepos</li>
</ol>
<input class=st-handbook id=search-handbook placeholder='Search through the handbook...'/>
<div class='hidden-md hidden-lg'>
<div class=codeowners>
<div>
<h4 class=codeowners-header>
Maintained by<span class='hidden-md hidden-lg'>:</span></h4>
</div>
<div class=codeowners-list>
<a class=codeowner href='https://gitlab.com/joshlambert'>
<img
src='/images/team/joshua.png'
class=codeowner-avatar-img
alt='Joshua Lambert'
title='Joshua Lambert'
>
</a>
<a class=codeowner href='https://gitlab.com/mjwood'>
<img
src='/images/team/markwood.jpg'
class=codeowner-avatar-img
alt='Mark Wood'
title='Mark Wood'
>
</a>
</div>
</div>
</div>
<ul id=markdown-toc>
<li><a href="#overview" id=markdown-toc-overview>Overview</a></li>
<li><a href="#existing-monorepo-experience-inside-of-gitlab" id=markdown-toc-existing-monorepo-experience-inside-of-gitlab>Existing monorepo experience inside of GitLab</a></li>
<li><a href="#whats-next--why" id=markdown-toc-whats-next--why>What's next &amp; why</a> <ul>
<li><a href="#bundle-uris" id=markdown-toc-bundle-uris>Bundle URIs</a></li>
<li><a href="#next-generation-reftables-backend-in-git" id=markdown-toc-next-generation-reftables-backend-in-git>Next generation reftables backend in Git</a></li>
<li><a href="#competitive-landscape" id=markdown-toc-competitive-landscape>Competitive landscape</a></li>
</ul>
</li>
</ul>
<h2 id=overview>Overview</h2>
<p>Monolithic repositories, more commonly known as monorepos, are a software
development approach where code for many projects is stored in a single
repository.</p>
<p>Monorepos provide a number of advantages such as reduced complexity, code reuse,
easier collaboration amongst teams, and streamlined dependency management.
Additionally, there are <a href="https://medium.com/@mattklein123/monorepos-please-dont-e9a279be011b">several drawbacks</a>
such as difficult to scale, performance concerns, requires large amounts of
storage, and loss of per-service semantic versioning.</p>
<h2 id=existing-monorepo-experience-inside-of-gitlab>Existing monorepo experience inside of GitLab</h2>
<p>We want to improve the monorepo experience - whether it has multiple services
that all get deployed together, or if it's a mobile app in a single repo that
needs to be built completely differently for iOS and Android.</p>
<p>The primary stages that will be supporting our development of a better monorepo
experience are:</p>
<ul>
<li><a href="/direction/gitaly">Gitaly</a></li>
<li><a href="/direction/dev/#create-1">Create</a></li>
<li><a href="/direction/verify/">Verify</a></li>
<li><a href="/direction/secure/static-analysis/sast/">Secure::SAST</a></li>
</ul>
<p>Secondary stages contributing to the betterment of monorepos in GitLab are:</p>
<ul>
<li><a href="/direction/ops/#package">Package</a></li>
<li><a href="https://about.gitlab.com/direction/ops/#configure">Configure</a></li>
</ul>
<p>GitLab already has a number of important features that help monorepos:</p>
<ul>
<li><a href="https://docs.gitlab.com/ee/topics/git/lfs/index.html#git-lfs">Git LFS</a></li>
<li><a href="https://docs.gitlab.com/ee/ci/parent_child_pipelines.html">Parent-child pipelines</a></li>
<li><a href="https://docs.gitlab.com/ee/ci/parent_child_pipelines.html#dynamic-child-pipelines">Dynamic pipeline creation for artifact includes</a></li>
<li><a href="https://docs.gitlab.com/ee/user/packages/npm_registry/index.html">Monorepo package management</a></li>
</ul>
<h2 id=whats-next--why>What's next &amp; why</h2>
<p>The primary way for us to improve the monorepo experience is by focusing on
scale &amp; performance.</p>
<h3 id=bundle-uris><a href="https://gitlab.com/groups/gitlab-org/-/epics/8939">Bundle URIs</a></h3>
<p>Bundle URIs is a <a href="https://git-scm.com/docs/bundle-uri">Git feature</a> whereby a
clone or fetch can be served through an http link to a bundle. This has the
distinct advantage of saving the server from having to spin up a
<code>git-pack-objects</code> process to pack up the objects into a packfile to then send
over the wire.</p>
<h3 id=next-generation-reftables-backend-in-git><a href="https://gitlab.com/groups/gitlab-org/-/epics/4220">Next generation reftables backend in Git</a></h3>
<p>Currently in Git references are represented on disk as either separate files per
reference, or a packed-refs file that contains multiple references. This
implementation can be problematic in repositories with a huge number of
references. A new implementation of references in Git where a binary data
structure is used instead can greatly improve performance of both reading and
writing references.</p>
<p>This was proposed and worked on on the Git mailing list, but it hasn't yet been
upstreamed into the Git project. The Gitaly team will be doing the work to
upstream this feature into Git itself. This can have a vast improve performance
in monorepos.</p>
<h3 id=competitive-landscape>Competitive landscape</h3>
<p>GitHub has released a <a href="https://marketplace.visualstudio.com/items?itemName=github.remotehub">Remote Repository Plug-in</a>
to better meet the developer needs around monorepo experiences. This extension
enables users to quickly commit to GitHub directly from Visual Studio. This
empowers users to easily navigate some of the git complexities that come with
monorepos.</p>
<p>GitHub and Perforce recently announced a <a href="https://developer.microsoft.com/en-us/games/blog/microsoft-perforce-reimagining-game-production/">strategic partnership</a>
to combat the limitations of Git when it comes to developing on large mono
repositories. Perforce authored a set of GitHub Actions that allow the user to
spin up a Perforce Helix Core server when working on repositories that would
otherwise not be performant in GitHub alone.</p>
</div>
</div>
<div style='display: none'>
<a href="https://gitlab.com/-/ide/project/gitlab-com/www-gitlab-com/edit/master/-/source/direction/gitaly/monorepos/index.html.md" id=hidden-web-ide>Edit this page</a>
<a href="https://gitlab.com/gitlab-com/www-gitlab-com/blob/master/source/direction/gitaly/monorepos/index.html.md" id=hidden-page-source>View source</a>
</div>
<footer id=global-footer>
<slp-footer></slp-footer>
</footer>
<script src='/javascripts/be-footer.js?cacheBust=4cf1fb774d1'></script>
<script src="/javascripts/libs/jquery.min.js?cacheBust=4cf1fb774d1"></script>
<script src="/javascripts/libs/jquery-migrate-3.3.0.min.js?cacheBust=4cf1fb774d1"></script>
<script src="/javascripts/libs/bootstrap.min.js?cacheBust=4cf1fb774d1"></script>
<script src="/javascripts/libs/jqBootstrapValidation.js?cacheBust=4cf1fb774d1"></script>
<script src="/javascripts/scripts.js?cacheBust=4cf1fb774d1"></script>
<script src="/javascripts/libs/popperjs.js?cacheBust=4cf1fb774d1"></script>
<script src="/javascripts/highlight-tooltip.js?cacheBust=4cf1fb774d1"></script>
<script>
  //<![CDATA[
    $.ajax({
      url: '//munchkin.marketo.net/munchkin.js',
      dataType: 'script',
      cache: true,
      success: function() {
        Munchkin.init('194-VVC-221');
      }
    });
  //]]>
</script>
<script defer=true src='/javascripts/cbextras.js'></script>
<script src="/javascripts/generate-navigation-helpers.js"></script>
</body>
</html>
