<!DOCTYPE html>
<html lang=en>
<head>
<meta charset=UTF-8 />
<meta content='width=device-width, initial-scale=1.0' name=viewport />
<meta content='default-src &#39;self&#39; https: http:; script-src &#39;self&#39; &#39;unsafe-inline&#39; &#39;unsafe-eval&#39; https: http:; style-src &#39;self&#39; &#39;unsafe-inline&#39; https: http:; object-src https: http:; base-uri &#39;self&#39;; connect-src &#39;self&#39; https: http: wss: ws:; frame-src &#39;self&#39; https: http:; img-src &#39;self&#39; https: http: data:; manifest-src &#39;self&#39;; media-src &#39;self&#39; https: http:; worker-src &#39;self&#39; https: http:;' http-equiv=Content-Security-Policy />
<meta content='index, follow' name=robots />
<title>
GitLab Security Release: 16.6.2, 16.5.4, 16.4.4
|
GitLab
</title>
<meta content='Learn more about GitLab Security Release: 16.6.2, 16.5.4, 16.4.4 for GitLab Community Edition (CE) and Enterprise Edition (EE).' name=description />
<meta content='Learn more about GitLab Security Release: 16.6.2, 16.5.4, 16.4.4 for GitLab Community Edition (CE) and Enterprise Edition (EE).' name='twitter:description'/>
<meta content='Learn more about GitLab Security Release: 16.6.2, 16.5.4, 16.4.4 for GitLab Community Edition (CE) and Enterprise Edition (EE).' property='og:description'/>
<meta content=GitLab property='og:site_name'/>
<meta content='GitLab Security Release: 16.6.2, 16.5.4, 16.4.4' property='og:title'/>
<meta content='https://gitlab.com/gitlab-com/www-gitlab-com/' property='og:repo'/>
<meta content='https://gitlab.com/' property='og:instance'/>
<meta content='gitlab-com/www-gitlab-com/' property='og:path'/>
<meta content='releases/posts/2023-12-13-security-release-gitlab-16-6-2-released.html.md' property='og:relative_path'/>
<meta content='sites/uncategorized/' property='og:monorepo_site_path_fragment'/>
<meta content=article property='og:type'/>
<meta content='https://about.gitlab.com/releases/2023/12/13/security-release-gitlab-16-6-2-released/' property='og:url'/>
<meta content="https://about.gitlab.com/images/blogimages/security-cover-new.png" property="og:image">
<meta content="https://about.gitlab.com/images/blogimages/security-cover-new.png" name="twitter:image">
<meta content=summary_large_image name='twitter:card'/>
<meta content='@GitLab' name='twitter:site'/>
<meta content='GitLab Security Release: 16.6.2, 16.5.4, 16.4.4' name='twitter:title'/>
<meta content='@GitLab' name='twitter:creator'/>
<link href='/atom.xml' rel=alternate title=Blog type='application/atom+xml'/>
<link href='/all-releases.xml' rel=alternate title='All Releases' type='application/atom+xml'/>
<link href='/security-releases.xml' rel=alternate title='Security Releases' type='application/atom+xml'/>
<link href='/releases.xml' rel=alternate title='Major Releases' type='application/atom+xml'/>
<link href='/ico/favicon.ico?cache=2022041' rel='shortcut icon'/>
<link href='/ico/favicon-192x192.png?cache=2022041' rel=icon sizes=192x192 type='image/png'/>
<link href='/ico/favicon-160x160.png?cache=2022041' rel=icon sizes=160x160 type='image/png'/>
<link href='/ico/favicon-96x96.png?cache=2022041' rel=icon sizes=96x96 type='image/png'/>
<link href='/ico/favicon-16x16.png?cache=2022041' rel=icon sizes=16x16 type='image/png'/>
<link href='/ico/favicon-32x32.png?cache=2022041' rel=icon sizes=32x32 type='image/png'/>
<link href='/ico/apple-touch-icon-57x57.png?cache=2022041' rel=apple-touch-icon sizes=57x57 />
<link href='/ico/apple-touch-icon-114x114.png?cache=2022041' rel=apple-touch-icon sizes=114x114 />
<link href='/ico/apple-touch-icon-72x72.png?cache=2022041' rel=apple-touch-icon sizes=72x72 />
<link href='/ico/apple-touch-icon-144x144.png?cache=2022041' rel=apple-touch-icon sizes=144x144 />
<link href='/ico/apple-touch-icon-60x60.png?cache=2022041' rel=apple-touch-icon sizes=60x60 />
<link href='/ico/apple-touch-icon-120x120.png?cache=2022041' rel=apple-touch-icon sizes=120x120 />
<link href='/ico/apple-touch-icon-76x76.png?cache=2022041' rel=apple-touch-icon sizes=76x76 />
<link href='/ico/apple-touch-icon-152x152.png?cache=2022041' rel=apple-touch-icon sizes=152x152 />
<link href='/ico/apple-touch-icon-180x180.png?cache=2022041' rel=apple-touch-icon sizes=180x180 />
<meta content='#554488' name=msapplication-TileColor />
<meta content='/ico/mstile-144x144.png?cache=2022041' name=msapplication-TileImage />
<meta content='/ico/browserconfig.xml' name=msapplication-config />
<script src='https://cdn.cookielaw.org/consent/7f944245-c5cd-4eed-a90e-dd955adfdd08/OtAutoBlock.js'></script>
<script charset=UTF-8 data-domain-script=7f944245-c5cd-4eed-a90e-dd955adfdd08 src='https://cdn.cookielaw.org/scripttemplates/otSDKStub.js'></script>
<script>
  //<![CDATA[
    function OptanonWrapper() { }
  //]]>
</script>
<script>
  //<![CDATA[
    window.dataLayer = window.dataLayer || []
    function gtag(){dataLayer.push(arguments);}
    gtag('consent', 'default', {
      'analytics_storage': 'denied',
      'ad_storage': 'denied',
      'functionality_storage': 'denied',
      'region': [ 'AT', 'BE', 'BG', 'HR', 'CY', 'CZ', 'DK', 'EE', 'FI', 'FR', 'DE', 'GR', 'HU', 'IE', 'IT', 'LV', 'LT', 'LU', 'MT', 'NL', 'PL', 'PT', 'RO', 'SK', 'SI', 'ES', 'SE', 'IS', 'LI', 'NO', 'GB', 'PE', 'RU'],
      'wait_for_update': 500
    });
    gtag('consent', 'default', {
      'analytics_storage': 'granted',
      'ad_storage': 'granted',
      'functionality_storage': 'granted',
      'wait_for_update': 500
    });
    
    window.geofeed = (options) => {
      dataLayer.push({
        'event' : 'OneTrustCountryLoad',
        'oneTrustCountryId': options.country.toString()
      })
    }
    
    const json = document.createElement('script');
    json.setAttribute('src', 'https://geolocation.onetrust.com/cookieconsentpub/v1/geo/location/geofeed');
    document.head.appendChild(json);
  //]]>
</script>
<script>document.documentElement.className = 'html--js'</script>
<script async='' src='//cdn.bizible.com/scripts/bizible.js'></script>
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-37019925-1', 'auto', {allowLinker: true});
ga('require', 'GTM-WC3ZR2P');
</script>
<script>
(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NJXWQL');
</script>
<script>
(function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
(w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
})(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');
_st('install','5geYbhTxNzL5dsekC-B-','2.0.0');
</script>
<link href='https://about.gitlab.com/releases/2023/12/13/security-release-gitlab-16-6-2-released/' rel=canonical />
<link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,500,600,700' rel=stylesheet />
<link crossorigin=anonymous href='https://use.fontawesome.com/releases/v5.1.0/css/all.css' integrity='sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt' rel=stylesheet />
<link href='https://cdnjs.cloudflare.com/ajax/libs/tiny-slider/2.8.7/tiny-slider.css' rel=stylesheet />
<link href="/stylesheets/styles.css" rel=stylesheet /><link href="/stylesheets/highlight.css" rel=stylesheet />

<link href="/stylesheets/slippers.css?cacheBust=4cf1fb774d1" rel=stylesheet />
<link href="/stylesheets/be-navigation.css?cacheBust=4cf1fb774d1" rel=stylesheet />
<script>
dataLayer.push({'tags': ["security"]});
</script>
<script>
dataLayer.push({'category': 'releases'});
</script>
</head>
<body data-spy=scroll data-target='.qnav'>
<noscript>
<iframe height=0 src='//www.googletagmanager.com/ns.html?id=GTM-NJXWQL' style='display:none;visibility:hidden' width=0></iframe>
</noscript>
<template id=be-nav>
<div id=be-nav-target>
<slp-navigation></slp-navigation>
</div>
</template>
<nav class='slp-sticky slp-left-0 slp-right-0 slp-top-0 slp-bg-white slp-z-90' id=global-nav style='z-index: 1000000;'>
<be-navigation></be-navigation>
</nav>
<div class='search-box js-search-box'>
<i class='fa fa-search search-box-icon'></i>
<input class='search-input js-search st-header' placeholder='Search...'/>
<button aria-label='Close search' class='search-close js-search-toggle' type=button>
<i class='fa fa-times'></i>
</button>
</div>
<script src='/javascripts/be-navigation.js?cacheBust=4cf1fb774d1'></script>
<div class='blog article'>
<div class='wrapper body'>
<div class=category-back-link>
<a href="/releases/categories/releases/"><span>&#8592;</span>
<span>Back to</span>
<span>releases</span>
</a></div>
<span class=date>
Dec 13, 2023
</span>
<span>-</span>
<span class=author>
<a href="/company/team/#gitlab">Dominic Couture</a>
<a href="https://gitlab.com/dcouture"><span>&nbsp;</span>
<span class=author-gitlab>
<i class='fab fa-gitlab'></i>
</span>
</a><a href="https://twitter.com/gitlab"><span>&nbsp;</span>
<span class=author-twitter>
<i class='fab fa-twitter'></i>
</span>
</a></span>
<h1>
GitLab Security Release: 16.6.2, 16.5.4, 16.4.4
</h1>
<p class=description>
Learn more about GitLab Security Release: 16.6.2, 16.5.4, 16.4.4 for GitLab Community Edition (CE) and Enterprise Edition (EE).
</p>
<p></p>
<div class=cover style='background-image: url(/images/blogimages/security-cover-new.png);'></div>
<div class=content>

<p>Today we are releasing versions 16.6.2, 16.5.4, and 16.4.4 for GitLab Community Edition (CE) and Enterprise Edition (EE).</p>
<p>These versions contain important security fixes, and we strongly recommend that all GitLab installations be upgraded to
one of these versions immediately. GitLab.com is already running the patched version.</p>
<p>GitLab releases patches for vulnerabilities in dedicated security releases. There are two types of security releases:
a monthly, scheduled security release, released a week after the feature release (which deploys on the 3rd Thursday of each month),
and ad-hoc security releases for critical vulnerabilities. For more information, you can visit our <a href="https://about.gitlab.com/security/faq/">security FAQ</a>.
You can see all of our regular and security release blog posts <a href="/releases/categories/releases/">here</a>.
In addition, the issues detailing each vulnerability are made public on our
<a href="https://gitlab.com/gitlab-org/gitlab/-/issues/?sort=created_date&amp;state=closed&amp;label_name%5B%5D=bug%3A%3Avulnerability&amp;confidential=no&amp;first_page_size=100">issue tracker</a>
30 days after the release in which they were patched.</p>
<p>We are dedicated to ensuring all aspects of GitLab that are exposed to customers or that host customer data are held to
the highest security standards. As part of maintaining good security hygiene, it is highly recommended that all customers
upgrade to the latest security release for their supported version. You can read more
<a href="/blog/2020/05/20/gitlab-instance-security-best-practices/">best practices in securing your GitLab instance</a> in our blog post.</p>
<h3 id=recommended-action>Recommended Action</h3>
<p>We <strong>strongly recommend</strong> that all installations running a version affected by the issues described below are <strong>upgraded to the latest version as soon as possible</strong>.</p>
<p>When no specific deployment type (omnibus, source code, helm chart, etc.) of a product is mentioned, this means all types are affected.</p>
<h2 id=table-of-fixes>Table of fixes</h2>
<table>
<thead>
<tr>
<th>Title</th>
<th>Severity</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#smartcard-authentication-allows-impersonation-of-arbitrary-user-using-user's-public-certificate">Smartcard authentication allows impersonation of arbitrary user using user's public certificate</a></td>
<td>High</td>
</tr>
<tr>
<td><a href="#when-subgroup-is-allowed-to-merge-or-push-to-protected-branches,-subgroup-members-with-the-developer-role-may-gain-the-ability-to-push-or-merge">When subgroup is allowed to merge or push to protected branches, subgroup members with the Developer role may gain the ability to push or merge</a></td>
<td>Medium</td>
</tr>
<tr>
<td><a href="#the-gitlab-web-interface-does-not-ensure-the-integrity-of-information-when-downloading-the-source-code-from-installation-packages-or-tags">The GitLab web interface does not ensure the integrity of information when downloading the source code from installation packages or tags.</a></td>
<td>Medium</td>
</tr>
<tr>
<td><a href="#project-maintainer-can-escalate-to-project-owner-using-project-access-token-rotate-api">Project maintainer can escalate to Project owner using project access token rotate API</a></td>
<td>Medium</td>
</tr>
<tr>
<td><a href="#omission-of-double-encoding-in-file-names-facilitates-the-creation-of-repositories-with-malicious-content">Omission of Double Encoding in File Names Facilitates the Creation of Repositories with Malicious Content.</a></td>
<td>Medium</td>
</tr>
<tr>
<td><a href="#unvalidated-timespent-value-leads-to-unable-to-load-issues-on-issue-board">Unvalidated timeSpent value leads to unable to load issues on Issue board</a></td>
<td>Medium</td>
</tr>
<tr>
<td><a href="#developer-can-bypass-predefined-variables-via-rest-api">Developer can bypass predefined variables via REST API</a></td>
<td>Medium</td>
</tr>
<tr>
<td><a href="#auditor-users-can-create-merge-requests-on-projects-they-dont-have-access-to">Auditor users can create merge requests on projects they don't have access to</a></td>
<td>Low</td>
</tr>
</tbody>
</table>
<h3 id=smartcard-authentication-allows-impersonation-of-arbitrary-user-using-users-public-certificate>Smartcard authentication allows impersonation of arbitrary user using user's public certificate</h3>
<p>An improper certificate validation issue in Smartcard authentication in GitLab EE affecting all versions from 11.6 prior to 16.4.4, 16.5 prior to 16.5.4, and 16.6 prior to 16.6.2 allows an attacker to authenticate as another user given their public key if they use Smartcard authentication. Smartcard authentication is an experimental feature and has to be manually enabled by an administrator. This is a high severity issue (<code>CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N</code>, 7.4). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-6680">CVE-2023-6680</a>.</p>
<p>Thanks Lucas Serrano from PEReN (<a href="https://gitlab.com/LSerranoPEReN">@LSerranoPEReN</a>) for reporting this vulnerability.</p>
<h2 id=when-subgroup-is-allowed-to-merge-or-push-to-protected-branches-subgroup-members-with-the-developer-role-may-gain-the-ability-to-push-or-merge>When subgroup is allowed to merge or push to protected branches, subgroup members with the Developer role may gain the ability to push or merge</h2>
<p>An issue has been discovered in GitLab EE Premium and Ultimate affecting versions 16.4.3, 16.5.3, and 16.6.1. In projects using subgroups to define who can push and/or merge to protected branches, there may have been instances in which subgroup members with the Developer role were able to push or merge to protected branches. This is a medium severity issue (<code>CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N</code>, 6.5). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-6564">CVE-2023-6564</a>.</p>
<p>This vulnerability has been discovered internally by a GitLab team member.</p>
<p>The following script can help you identify projects that may be subject to a vulnerable configuration. This script can be used to create a CSV file listing projects that have a group set as "Allowed to merge" or "Allowed to push and merge" along with the web_url and project_id for the project and the group_name/group_id for the group. Note that this is not an indication that unauthorized changes were made to protected branches, but rather an indication that these projects were subject to this vulnerable configuration. For impacted projects, customers will need to check merge requests that were merged on their self-managed GitLab instances running 16.4.3, 16.5.3, or 16.6.1 prior to updating to 16.4.4, 16.5.4, or 16.6.2 or on GitLab.com prior to 2023-12-04 18:10 UTC.</p>
<details><summary>Click to expand the script</summary>
```sh
## install `glab` (if not already installed)
# https://gitlab.com/gitlab-org/cli#installation
## install `jq` (if not already installed)
# https://jqlang.github.io/jq/download/
# authenticate with `glab` as Admin (self-managed) or group owner (SaaS)
glab auth login
## get `project_id` and `web_url` for all projects at the instance level (self-managed) or group level (SaaS), save it as `project-list.csv`
# self-managed - instance level (use Admin PAT for authentication)
glab api --hostname "self-managed-gitlab.example.com" --paginate projects 2&gt;&gt; error.log | jq -c '.[]' | jq -rc '[.id, .web_url] | @csv' | tee -a project-list.csv
# SaaS - group level (use group owner PAT for authentication)
glab api --paginate "groups/$GROUP_ID/projects" 2&gt;&gt; error.log | jq -c '.[]' | jq -rc '[.id, .web_url] | @csv' | tee -a project-list.csv
## add headers to protected_branch_report.csv file
echo "project_id, web_url, group_name_push_access, group_id_push_access, group_name_merge_access, group_id_merge_access" &gt; protected_branch_report.csv
## loop through each project to check for protected branches that have a group with push or merge access
while IFS=',' read -r PROJECT_ID WEB_URL; do
glab api "projects/$PROJECT_ID/protected_branches" 2&gt;&gt; error.log \
| jq -c '.[]' \
| jq 'select((any(.push_access_levels[]; .group_id != null and .access_level == 40)) or (any(.merge_access_levels[]; .group_id != null and .access_level == 40)))' 2&gt;&gt; error.log \
| jq -c "{project_id: $PROJECT_ID, web_url: $WEB_URL, group_id_push_access: .push_access_levels.[].group_id, group_name_push_access: .push_access_levels.[].access_level_description, group_id_merge_access: .merge_access_levels.[].group_id, group_name_merge_access: .merge_access_levels.[].access_level_description}" 2&gt;&gt; error.log \
| jq 'select((.group_id_push_access != null or .group_id_merge_access != null) and (.group_name_push_access != "Maintainers" or .group_name_merge_access != "Maintainers"))' 2&gt;&gt; error.log \
| jq -rc '[.project_id, .web_url, .group_name_push_access, .group_id_push_access, .group_name_merge_access, .group_id_merge_access] | @csv' \
| tee -a protected_branch_report.csv
done &lt; project-list.csv
```
GitLab has conducted limited testing to validate this script. As such this script is provided AS-IS and GitLab makes no warranties of any kind. GITLAB HEREBY DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING, WITHOUT LIMITATION, ALL IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, TITLE, AND NON-INFRINGEMENT.
</details>
<h3 id=the-gitlab-web-interface-does-not-ensure-the-integrity-of-information-when-downloading-the-source-code-from-installation-packages-or-tags>The GitLab web interface does not ensure the integrity of information when downloading the source code from installation packages or tags.</h3>
<p>An issue has been discovered in GitLab CE/EE affecting all versions before 16.4.4, all versions starting from 16.5 before 16.5.4, all versions starting from 16.6 before 16.6.2. File integrity may be compromised when source code or installation packages are pulled from a specific tag.
This is a medium severity issue (<code>CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:H/A:N</code>, 5.7).
It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-6051">CVE-2023-6051</a>.</p>
<p>Thanks <a href="https://hackerone.com/st4nly0n">st4nly0n</a> for reporting this vulnerability through our HackerOne bug bounty program.</p>
<h3 id=project-maintainer-can-escalate-to-project-owner-using-project-access-token-rotate-api>Project maintainer can escalate to Project owner using project access token rotate API</h3>
<p>A privilege escalation vulnerability in GitLab EE affecting all versions from 16.0 prior to 16.4.4, 16.5 prior to 16.5.4, and 16.6 prior to 16.6.2 allows a project Maintainer to use a Project Access Token to escalate their role to Owner.
This is a medium severity issue (<code>CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:H/A:N</code>, 4.9).
It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-3907">CVE-2023-3907</a>.</p>
<p>Thanks <a href="https://hackerone.com/ashish_r_padelkar">ashish_r_padelkar</a> for reporting this vulnerability through our HackerOne bug bounty program.</p>
<h3 id=omission-of-double-encoding-in-file-names-facilitates-the-creation-of-repositories-with-malicious-content>Omission of Double Encoding in File Names Facilitates the Creation of Repositories with Malicious Content.</h3>
<p>An issue has been discovered in GitLab CE/EE affecting all versions from 16.3 before 16.4.4, all versions starting from 16.5 before 16.5.4, all versions starting from 16.6 before 16.6.2. File integrity may be compromised when specific HTML encoding is used for file names leading for incorrect representation in the UI.
This is a medium severity issue (<code>CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:N/I:H/A:N</code>, 4.8).
It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-5512">CVE-2023-5512</a>.</p>
<p>Thanks <a href="https://hackerone.com/st4nly0n">st4nly0n</a> for reporting this vulnerability through our HackerOne bug bounty program.</p>
<h3 id=unvalidated-timespent-value-leads-to-unable-to-load-issues-on-issue-board>Unvalidated timeSpent value leads to unable to load issues on Issue board</h3>
<p>An issue has been discovered in GitLab EE affecting all versions starting before 16.4.4, all versions starting from 16.5 before 16.5.4, all versions starting from 16.6 before 16.6.2. It was possible to overflow the time spent on an issue that altered the details shown in the issue boards.
This is a medium severity issue (<code>CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L</code>, 4.3).
It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-3904">CVE-2023-3904</a>.</p>
<p>Thanks <a href="https://hackerone.com/toukakirishima">toukakirishima</a> for reporting this vulnerability through our HackerOne bug bounty program.</p>
<h3 id=developer-can-bypass-predefined-variables-via-rest-api>Developer can bypass predefined variables via REST API</h3>
<p>An issue has been discovered in GitLab affecting all versions starting from 9.3 before 16.4.4, all versions starting from 16.5 before 16.5.4, all versions starting from 16.6 before 16.6.2. In certain situations, it may have been possible for developers to override predefined CI variables via the REST API. This is a medium severity issue (<code>CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N</code>, 4.3). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-5061">CVE-2023-5061</a>.</p>
<p>Thanks <a href="https://hackerone.com/ali_shehab">ali_shehab</a> for reporting this vulnerability through our HackerOne bug bounty program.</p>
<h3 id=auditor-users-can-create-merge-requests-on-projects-they-dont-have-access-to>Auditor users can create merge requests on projects they don't have access to</h3>
<p>An issue has been discovered in GitLab EE affecting all versions starting from 8.17 before 16.4.4, all versions starting from 16.5 before 16.5.4, all versions starting from 16.6 before 16.6.2. It was possible for auditor users to fork and submit merge requests to private projects they're not a member of. This is a low severity issue (<code>CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:N/I:L/A:N</code>, 2.0). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-3511">CVE-2023-3511</a>.</p>
<p>Thanks <a href="https://hackerone.com/js_noob">js_noob</a> for reporting this vulnerability through our HackerOne bug bounty program.</p>
<h2 id=non-security-patches>Non Security Patches</h2>
<h3 id=1662>16.6.2</h3>
<ul>
<li><a href="https://gitlab.com/gitlab-org/build/CNG/-/merge_requests/1649">[Backport 16.6] Fix redis-namspace dependency version for UBI mailroom</a></li>
<li><a href="https://gitlab.com/gitlab-org/build/CNG/-/merge_requests/1658">Fix backup id parsing from backup URLs (16.6 Backport)</a></li>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/138449">Package Registry: Truncate Pypi metadata description field</a></li>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/138535">Fix adding confidential child tasks</a></li>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/138797">Backport Hide obsolete migration warning into 16.6</a></li>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/138911">[16.6 Backport] Fix Admin Mode bug in DeactivateDormantUsersWorker</a></li>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/138929">Backport Fix cluster reindexing service preflight check to 16.6</a></li>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/138804">Backport Sanitize string provided to to_tsvector</a></li>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/138602">Backport "Update migration to work for any fk name" to 16.6</a></li>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/139051">Fix Environment destroy job is retried endlessly (16.6 backport)</a></li>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/138431">Allow users to authenticate via OAuth with password-based providers</a></li>
<li><a href="https://gitlab.com/gitlab-org/omnibus-gitlab/-/merge_requests/7275">Do not scan entire /var/opt/gitlab for stale pids (16.6 backport)</a></li>
</ul>
<h3 id=1654>16.5.4</h3>
<ul>
<li><a href="https://gitlab.com/gitlab-org/build/CNG/-/merge_requests/1641">gitlab-rails: support skipping post-migrations in db checks</a></li>
<li><a href="https://gitlab.com/gitlab-org/build/CNG/-/merge_requests/1650">[Backport 16.5] Fix redis-namspace dependency version for UBI mailroom</a></li>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/137712">Backport - Truncate verification failure message to 255</a></li>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/138912">[16.5 Backport] Fix Admin Mode bug in DeactivateDormantUsersWorker</a></li>
</ul>
<h3 id=1644>16.4.4</h3>
<ul>
<li><a href="https://gitlab.com/gitlab-org/build/CNG/-/merge_requests/1651">[Backport 16.4] Fix redis-namspace dependency version for UBI mailroom</a></li>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/138913">[16.4 Backport] Fix Admin Mode bug in DeactivateDormantUsersWorker</a></li>
</ul>
<h2 id=updating>Updating</h2>
<p>To update GitLab, see the <a href="/update">Update page</a>.
To update Gitlab Runner, see the <a href="https://docs.gitlab.com/runner/install/linux-repository.html#updating-the-runner">Updating the Runner page</a>.</p>
<h2 id=receive-security-release-notifications>Receive Security Release Notifications</h2>
<p>To receive security release blog notifications delivered to your inbox, visit our <a href="https://about.gitlab.com/company/contact/">contact us</a> page.
To receive release notifications via RSS, subscribe to our <a href="https://about.gitlab.com/security-releases.xml">security release RSS feed</a> or our <a href="https://about.gitlab.com/all-releases.xml">RSS feed for all releases</a>.</p>
<div class='panel panel-default twitter-block'>
<a class='twitter-block-link panel-body' href='http://twitter.com/share?text=GitLab+Security+Release%3A+16.6.2%2C+16.5.4%2C+16.4.4+via+%40gitlab&amp;url=https://about.gitlab.com/releases/2023/12/13/security-release-gitlab-16-6-2-released/&amp;hashtags=' rel=nofollow target=_blank title='Tweet!'>
<span class='twitter-text pull-left'>
GitLab Security Release: 16.6.2, 16.5.4, 16.4.4
via @gitlab
</span>
<span class=click-to-tweet>
Click to tweet!
<i class='fab fa-twitter'></i>
</span>
</a>
</div>
</div>
<ul class='tag-list list-unstyled'>
<li class=tag>
<a href="/releases/tags.html#security">security</a>
</li>
</ul>
<div class=social>
<div class='share-butons clearfix'>
<a class='share-btn share-btn-facebook' href='http://www.facebook.com/sharer.php?u=https://about.gitlab.com/releases/2023/12/13/security-release-gitlab-16-6-2-released/' onclick='openSocialLink(this, 500, 400); return false;' target=_blank>
<i class='fab fa-facebook'></i>
<span class=sr-only>
Share on Facebook
</span>
</a>
<a class='share-btn share-btn-twitter' href='http://twitter.com/share?url=https://about.gitlab.com/releases/2023/12/13/security-release-gitlab-16-6-2-released/&amp;text=GitLab Security Release: 16.6.2, 16.5.4, 16.4.4' onclick='openSocialLink(this, 500, 400); return false;' target=_blank>
<i class='fab fa-twitter'></i>
<span class=sr-only>
Share on Twitter
</span>
</a>
<a class='share-btn share-btn-linkedin' href='https://www.linkedin.com/shareArticle?mini=true&amp;url=https://about.gitlab.com/releases/2023/12/13/security-release-gitlab-16-6-2-released/&amp;title=GitLab Security Release: 16.6.2, 16.5.4, 16.4.4&amp;summary=&amp;source=' onclick='openSocialLink(this, 500, 400); return false;' target=_blank>
<i class='fab fa-linkedin'></i>
<span class=sr-only>
Share on LinkedIn
</span>
</a>
<a class='share-btn share-btn-hackernews' href='https://news.ycombinator.com/submitlink?u=https://about.gitlab.com/releases/2023/12/13/security-release-gitlab-16-6-2-released/&amp;t=GitLab Security Release: 16.6.2, 16.5.4, 16.4.4' onclick='openSocialLink(this, 500, 400); return false;' target=_blank>
<i class='fab fa-hacker-news'></i>
<span class=sr-only>
Share on Hacker News
</span>
</a>
</div>
</div>
<nav aria-label='Blog post pager'>
<ul class=pager>
<li class=pull-left>
<a href="/releases/2023/11/30/security-release-gitlab-16-6-1-released/" title="GitLab Security Release: 16.6.1, 16.5.3, 16.4.3"><i class='fa fa-chevron-left'></i>
<span class=screen-reader-text>Previous Post:</span>
<span class=adjacent_post_title>
GitLab Security Release: 16.6.1, 16.5.3, 16.4.3
</span>
</a></li>
<li class=pull-right>
<a href="/releases/2023/12/21/gitlab-16-7-released/" title="GitLab 16.7 released with general availability of GitLab Duo Code Suggestions and CI/CD Catalog in Beta"><span class=screen-reader-text>Next Post:</span>
<span class=adjacent_post_title>
GitLab 16.7 released with general availability of GitLab
...
</span>
<i class='fa fa-chevron-right'></i>
</a></li>
</ul>
</nav>
</div>
<div class='wrapper signup'>
<div class="panel panel-default nl panel-newsletter-signup">
<div class=row>
<div class="col-12 newsletter">
<div class=newsletter-form style="margin: 32px 0">
<span class=newsletter-preamble>
Sign up for GitLab's monthly newsletter
</span>
<script src="//page.gitlab.com/js/forms2/js/forms2.min.js"></script>
<form id=mktoForm_1077 style="display: initial"></form>
<script>

          MktoForms2.setOptions(
          {
            formXDPath : "/rs/194-VVC-221/images/marketo-xdframe-relative.html"
          });
          MktoForms2.loadForm("//page.gitlab.com", "194-VVC-221", 1077, function(form) {
            form.onSuccess(function(values, followUpUrl) {

              dataLayer.push(
              {
                'event' : 'mktoLead', 
                'mktoFormId' : form.getId(),
                'eventCallback' : function()
                {
                  form.getFormElem().hide();
                  document.getElementById('confirmform').style.display = 'block';
                }, 'eventTimeout' : 3000
              });
              return false;
            });
            function getgacid() {
              try {
                var tracker = ga.getAll()[0];
                return tracker.get('clientId');
              } catch (e) {
                return 'n/a';
              }
            }
            form.vals({
              'gacid': getgacid()
            });
          });
        </script>
<div id=confirmform class=confirm-message style="display:none;"><p>Thanks for subscribing!</p></div>
</div>
</div>
</div>
</div>
</div>
<div class=gitlab-trial>
<div class=gitlab-trial__wrapper>
<div class=gitlab-trial__left-side>
<h2>
Take GitLab for a spin
</h2>
<p>
See what your team could do with The DevSecOps Platform.
</p>
<a href="https://gitlab.com/-/trials/new?glm_content=default-saas-trial&amp;glm_source=about.gitlab.com" class="btn cta-btn" data-ga-name="free trial" data-ga-location="try partial">Get free trial</a>
</div>
<div class=gitlab-trial__right-side>
<img src="/images/cta/gitlab-enterprise-team-member-photos.png" alt=""/>
<p>
Have a question? We're here to help.
</p>
<a class=sales-cta href='https://about.gitlab.com/sales/'>
Talk to an expert
</a>
</div>
</div>
</div>
<div style='display: none'>
<a href="https://gitlab.com/-/ide/project/gitlab-com/www-gitlab-com/edit/master/-/sites/uncategorized/source/releases/posts/2023-12-13-security-release-gitlab-16-6-2-released.html.md" id=hidden-web-ide>Edit this page</a>
<a href="https://gitlab.com/gitlab-com/www-gitlab-com/blob/master/sites/uncategorized/source/releases/posts/2023-12-13-security-release-gitlab-16-6-2-released.html.md" id=hidden-page-source>View source</a>
</div>
<footer id=global-footer>
<slp-footer></slp-footer>
</footer>
<script src='/javascripts/be-footer.js?cacheBust=4cf1fb774d1'></script>
<script src="/javascripts/libs/jquery.min.js?cacheBust=4cf1fb774d1"></script>
<script src="/javascripts/libs/jquery-migrate-3.3.0.min.js?cacheBust=4cf1fb774d1"></script>
<script src="/javascripts/libs/bootstrap.min.js?cacheBust=4cf1fb774d1"></script>
<script src="/javascripts/libs/jqBootstrapValidation.js?cacheBust=4cf1fb774d1"></script>
<script src="/javascripts/scripts.js?cacheBust=4cf1fb774d1"></script>
<script>
  //<![CDATA[
    $.ajax({
      url: '//munchkin.marketo.net/munchkin.js',
      dataType: 'script',
      cache: true,
      success: function() {
        Munchkin.init('194-VVC-221');
      }
    });
  //]]>
</script>
<script defer=true src='/javascripts/cbextras.js'></script>
</div>
</body>
</html>
