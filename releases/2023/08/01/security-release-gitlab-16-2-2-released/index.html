<!DOCTYPE html>
<html lang=en>
<head>
<meta charset=UTF-8 />
<meta content='width=device-width, initial-scale=1.0' name=viewport />
<meta content='default-src &#39;self&#39; https: http:; script-src &#39;self&#39; &#39;unsafe-inline&#39; &#39;unsafe-eval&#39; https: http:; style-src &#39;self&#39; &#39;unsafe-inline&#39; https: http:; object-src https: http:; base-uri &#39;self&#39;; connect-src &#39;self&#39; https: http: wss: ws:; frame-src &#39;self&#39; https: http:; img-src &#39;self&#39; https: http: data:; manifest-src &#39;self&#39;; media-src &#39;self&#39; https: http:; worker-src &#39;self&#39; https: http:;' http-equiv=Content-Security-Policy />
<meta content='index, follow' name=robots />
<title>
GitLab Security Release: 16.2.2, 16.1.3, and 16.0.8
|
GitLab
</title>
<meta content='Learn more about GitLab Security Release: 16.2.2, 16.1.3, and 16.0.8 for GitLab Community Edition (CE) and Enterprise Edition (EE).' name=description />
<meta content='Learn more about GitLab Security Release: 16.2.2, 16.1.3, and 16.0.8 for GitLab Community Edition (CE) and Enterprise Edition (EE).' name='twitter:description'/>
<meta content='Learn more about GitLab Security Release: 16.2.2, 16.1.3, and 16.0.8 for GitLab Community Edition (CE) and Enterprise Edition (EE).' property='og:description'/>
<meta content=GitLab property='og:site_name'/>
<meta content='GitLab Security Release: 16.2.2, 16.1.3, and 16.0.8' property='og:title'/>
<meta content='https://gitlab.com/gitlab-com/www-gitlab-com/' property='og:repo'/>
<meta content='https://gitlab.com/' property='og:instance'/>
<meta content='gitlab-com/www-gitlab-com/' property='og:path'/>
<meta content='releases/posts/2023-08-01-security-release-gitlab-16-2-2-released.html.md' property='og:relative_path'/>
<meta content='sites/uncategorized/' property='og:monorepo_site_path_fragment'/>
<meta content=article property='og:type'/>
<meta content='https://about.gitlab.com/releases/2023/08/01/security-release-gitlab-16-2-2-released/' property='og:url'/>
<meta content="https://about.gitlab.com/images/blogimages/security-cover-new.png" property="og:image">
<meta content="https://about.gitlab.com/images/blogimages/security-cover-new.png" name="twitter:image">
<meta content=summary_large_image name='twitter:card'/>
<meta content='@GitLab' name='twitter:site'/>
<meta content='GitLab Security Release: 16.2.2, 16.1.3, and 16.0.8' name='twitter:title'/>
<meta content='@GitLab' name='twitter:creator'/>
<link href='/atom.xml' rel=alternate title=Blog type='application/atom+xml'/>
<link href='/all-releases.xml' rel=alternate title='All Releases' type='application/atom+xml'/>
<link href='/security-releases.xml' rel=alternate title='Security Releases' type='application/atom+xml'/>
<link href='/releases.xml' rel=alternate title='Major Releases' type='application/atom+xml'/>
<link href='/ico/favicon.ico?cache=2022041' rel='shortcut icon'/>
<link href='/ico/favicon-192x192.png?cache=2022041' rel=icon sizes=192x192 type='image/png'/>
<link href='/ico/favicon-160x160.png?cache=2022041' rel=icon sizes=160x160 type='image/png'/>
<link href='/ico/favicon-96x96.png?cache=2022041' rel=icon sizes=96x96 type='image/png'/>
<link href='/ico/favicon-16x16.png?cache=2022041' rel=icon sizes=16x16 type='image/png'/>
<link href='/ico/favicon-32x32.png?cache=2022041' rel=icon sizes=32x32 type='image/png'/>
<link href='/ico/apple-touch-icon-57x57.png?cache=2022041' rel=apple-touch-icon sizes=57x57 />
<link href='/ico/apple-touch-icon-114x114.png?cache=2022041' rel=apple-touch-icon sizes=114x114 />
<link href='/ico/apple-touch-icon-72x72.png?cache=2022041' rel=apple-touch-icon sizes=72x72 />
<link href='/ico/apple-touch-icon-144x144.png?cache=2022041' rel=apple-touch-icon sizes=144x144 />
<link href='/ico/apple-touch-icon-60x60.png?cache=2022041' rel=apple-touch-icon sizes=60x60 />
<link href='/ico/apple-touch-icon-120x120.png?cache=2022041' rel=apple-touch-icon sizes=120x120 />
<link href='/ico/apple-touch-icon-76x76.png?cache=2022041' rel=apple-touch-icon sizes=76x76 />
<link href='/ico/apple-touch-icon-152x152.png?cache=2022041' rel=apple-touch-icon sizes=152x152 />
<link href='/ico/apple-touch-icon-180x180.png?cache=2022041' rel=apple-touch-icon sizes=180x180 />
<meta content='#554488' name=msapplication-TileColor />
<meta content='/ico/mstile-144x144.png?cache=2022041' name=msapplication-TileImage />
<meta content='/ico/browserconfig.xml' name=msapplication-config />
<script src='https://cdn.cookielaw.org/consent/7f944245-c5cd-4eed-a90e-dd955adfdd08/OtAutoBlock.js'></script>
<script charset=UTF-8 data-domain-script=7f944245-c5cd-4eed-a90e-dd955adfdd08 src='https://cdn.cookielaw.org/scripttemplates/otSDKStub.js'></script>
<script>
  //<![CDATA[
    function OptanonWrapper() { }
  //]]>
</script>
<script>
  //<![CDATA[
    window.dataLayer = window.dataLayer || []
    function gtag(){dataLayer.push(arguments);}
    gtag('consent', 'default', {
      'analytics_storage': 'denied',
      'ad_storage': 'denied',
      'functionality_storage': 'denied',
      'region': [ 'AT', 'BE', 'BG', 'HR', 'CY', 'CZ', 'DK', 'EE', 'FI', 'FR', 'DE', 'GR', 'HU', 'IE', 'IT', 'LV', 'LT', 'LU', 'MT', 'NL', 'PL', 'PT', 'RO', 'SK', 'SI', 'ES', 'SE', 'IS', 'LI', 'NO', 'GB', 'PE', 'RU'],
      'wait_for_update': 500
    });
    gtag('consent', 'default', {
      'analytics_storage': 'granted',
      'ad_storage': 'granted',
      'functionality_storage': 'granted',
      'wait_for_update': 500
    });
    
    window.geofeed = (options) => {
      dataLayer.push({
        'event' : 'OneTrustCountryLoad',
        'oneTrustCountryId': options.country.toString()
      })
    }
    
    const json = document.createElement('script');
    json.setAttribute('src', 'https://geolocation.onetrust.com/cookieconsentpub/v1/geo/location/geofeed');
    document.head.appendChild(json);
  //]]>
</script>
<script>document.documentElement.className = 'html--js'</script>
<script async='' src='//cdn.bizible.com/scripts/bizible.js'></script>
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-37019925-1', 'auto', {allowLinker: true});
ga('require', 'GTM-WC3ZR2P');
</script>
<script>
(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NJXWQL');
</script>
<script>
(function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
(w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
})(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');
_st('install','5geYbhTxNzL5dsekC-B-','2.0.0');
</script>
<link href='https://about.gitlab.com/releases/2023/08/01/security-release-gitlab-16-2-2-released/' rel=canonical />
<link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,500,600,700' rel=stylesheet />
<link crossorigin=anonymous href='https://use.fontawesome.com/releases/v5.1.0/css/all.css' integrity='sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt' rel=stylesheet />
<link href='https://cdnjs.cloudflare.com/ajax/libs/tiny-slider/2.8.7/tiny-slider.css' rel=stylesheet />
<link href="/stylesheets/styles.css" rel=stylesheet /><link href="/stylesheets/highlight.css" rel=stylesheet />

<link href="/stylesheets/slippers.css?cacheBust=4cf1fb774d1" rel=stylesheet />
<link href="/stylesheets/be-navigation.css?cacheBust=4cf1fb774d1" rel=stylesheet />
<script>
dataLayer.push({'tags': ["security"]});
</script>
<script>
dataLayer.push({'category': 'releases'});
</script>
</head>
<body data-spy=scroll data-target='.qnav'>
<noscript>
<iframe height=0 src='//www.googletagmanager.com/ns.html?id=GTM-NJXWQL' style='display:none;visibility:hidden' width=0></iframe>
</noscript>
<template id=be-nav>
<div id=be-nav-target>
<slp-navigation></slp-navigation>
</div>
</template>
<nav class='slp-sticky slp-left-0 slp-right-0 slp-top-0 slp-bg-white slp-z-90' id=global-nav style='z-index: 1000000;'>
<be-navigation></be-navigation>
</nav>
<div class='search-box js-search-box'>
<i class='fa fa-search search-box-icon'></i>
<input class='search-input js-search st-header' placeholder='Search...'/>
<button aria-label='Close search' class='search-close js-search-toggle' type=button>
<i class='fa fa-times'></i>
</button>
</div>
<script src='/javascripts/be-navigation.js?cacheBust=4cf1fb774d1'></script>
<div class='blog article'>
<div class='wrapper body'>
<div class=category-back-link>
<a href="/releases/categories/releases/"><span>&#8592;</span>
<span>Back to</span>
<span>releases</span>
</a></div>
<span class=date>
Aug 1, 2023
</span>
<span>-</span>
<span class=author>
<a href="/company/team/#greg">Greg Myers</a>
<a href="https://gitlab.com/greg"><span>&nbsp;</span>
<span class=author-gitlab>
<i class='fab fa-gitlab'></i>
</span>
</a></span>
<h1>
GitLab Security Release: 16.2.2, 16.1.3, and 16.0.8
</h1>
<p class=description>
Learn more about GitLab Security Release: 16.2.2, 16.1.3, and 16.0.8 for GitLab Community Edition (CE) and Enterprise Edition (EE).
</p>
<p></p>
<div class=cover style='background-image: url(/images/blogimages/security-cover-new.png);'></div>
<div class=content>
<p>Today we are releasing versions 16.2.2, 16.1.3, and 16.0.8 for GitLab Community Edition (CE) and Enterprise Edition (EE).</p>
<p>These versions contain important security fixes, and we strongly recommend that all GitLab installations be upgraded to one of these versions immediately. GitLab.com is already running the patched version.</p>
<p>GitLab releases patches for vulnerabilities in dedicated security releases. There are two types of security releases: a monthly, scheduled security release, released a week after the feature release (which deploys on the 22nd of each month), and ad-hoc security releases for critical vulnerabilities. For more information, you can visit our <a href="https://about.gitlab.com/security/faq/">security FAQ</a>. You can see all of our regular and security release blog posts <a href="/releases/categories/releases/">here</a>. In addition, the issues detailing each vulnerability are made public on our <a href="https://gitlab.com/gitlab-org/gitlab/-/issues/?sort=created_date&amp;state=closed&amp;label_name%5B%5D=bug%3A%3Avulnerability&amp;confidential=no&amp;first_page_size=100">issue tracker</a> 30 days after the release in which they were patched.</p>
<p>We are dedicated to ensuring all aspects of GitLab that are exposed to customers or that host customer data are held to the highest security standards. As part of maintaining good security hygiene, it is highly recommended that all customers upgrade to the latest security release for their supported version. You can read more <a href="/blog/2020/05/20/gitlab-instance-security-best-practices/">best practices in securing your GitLab instance</a> in our blog post.</p>
<h3 id=recommended-action>Recommended Action</h3>
<p>We <strong>strongly recommend</strong> that all installations running a version affected by the issues described below are <strong>upgraded to the latest version as soon as possible</strong>.</p>
<p>When no specific deployment type (omnibus, source code, helm chart, etc.) of a product is mentioned, this means all types are affected.</p>
<h2 id=table-of-fixes>Table of Fixes</h2>
<table>
<thead>
<tr>
<th>Title</th>
<th>Severity</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#redos-via-projectreferencefilter-in-any-markdown-fields">ReDoS via ProjectReferenceFilter in any Markdown fields</a></td>
<td>high</td>
</tr>
<tr>
<td><a href="#redos-via-autolinkfilter-in-any-markdown-fields">ReDoS via AutolinkFilter in any Markdown fields</a></td>
<td>high</td>
</tr>
<tr>
<td><a href="#an-attacker-can-run-pipeline-jobs-as-arbitrary-user">An attacker can run pipeline jobs as arbitrary user</a></td>
<td>high</td>
</tr>
<tr>
<td><a href="#regex-dos-in-harbor-registry-search">Regex DoS in Harbor Registry search</a></td>
<td>medium</td>
</tr>
<tr>
<td><a href="#arbitrary-read-of-files-owned-by-the-git-user-via-malicious-targz-file-upload-using-gitlab-export-functionality">Arbitrary read of files owned by the "git" user via malicious tar.gz file upload using GitLab export functionality</a></td>
<td>medium</td>
</tr>
<tr>
<td><a href="#stored-xss-in-web-ide-beta-via-crafted-url">Stored XSS in Web IDE Beta via crafted URL</a></td>
<td>medium</td>
</tr>
<tr>
<td><a href="#securitypolicyprojectassign-mutation-does-not-authorize-security-policy-project-id"><code>securityPolicyProjectAssign</code> mutation does not authorize security policy project ID</a></td>
<td>medium</td>
</tr>
<tr>
<td><a href="#possible-pages-unique-domain-overwrite">Possible Pages Unique Domain Overwrite</a></td>
<td>medium</td>
</tr>
<tr>
<td><a href="#access-tokens-may-have-been-logged-when-a-query-was-made-to-an-endpoint">Access tokens may have been logged when a query was made to an endpoint</a></td>
<td>medium</td>
</tr>
<tr>
<td><a href="#reflected-xss-via-plantuml-diagram">Reflected XSS via PlantUML diagram</a></td>
<td>medium</td>
</tr>
<tr>
<td><a href="#the-main-branch-of-a-repository-with-a-specially-designed-name-may-allow-an-attacker-to-create-repositories-with-malicious-code">The main branch of a repository with a specially designed name may allow an attacker to create repositories with malicious code</a></td>
<td>medium</td>
</tr>
<tr>
<td><a href="#invalid-start_sha-value-on-merge-requests-page-may-lead-to-denial-of-service">Invalid 'start_sha' value on merge requests page may lead to Denial of Service</a></td>
<td>medium</td>
</tr>
<tr>
<td><a href="#developers-can-create-pipeline-schedules-on-protected-branches-even-if-they-dont-have-access-to-merge">Developers can create pipeline schedules on protected branches even if they don't have access to merge</a></td>
<td>medium</td>
</tr>
<tr>
<td><a href="#potential-dos-due-to-lack-of-pagination-while-loading-license-data">Potential DOS due to lack of pagination while loading license data</a></td>
<td>medium</td>
</tr>
<tr>
<td><a href="#leaking-emails-of-newly-created-users">Leaking emails of newly created users</a></td>
<td>low</td>
</tr>
</tbody>
</table>
<h2 id=redos-via-projectreferencefilter-in-any-markdown-fields>ReDoS via ProjectReferenceFilter in any Markdown fields</h2>

<p>An issue has been discovered in GitLab CE/EE affecting all versions starting from 9.3 before 16.0.8, all versions starting from 16.1 before 16.1.3, all versions starting from 16.2 before 16.2.2. A Regular Expression Denial of Service was possible via sending crafted payloads which use ProjectReferenceFilter to the preview_markdown endpoint. This is a high severity issue (<code>CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H</code>, 7.5). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-3994">CVE-2023-3994</a>.</p>
<p>Thanks <a href="https://hackerone.com/ryhmnlfj">ryhmnlfj</a> for reporting this vulnerability through our HackerOne bug bounty program.</p>
<h2 id=redos-via-autolinkfilter-in-any-markdown-fields>ReDoS via AutolinkFilter in any Markdown fields</h2>

<p>An issue has been discovered in GitLab CE/EE affecting all versions starting from 8.14 before 16.0.8, all versions starting from 16.1 before 16.1.3, all versions starting from 16.2 before 16.2.2. A Regular Expression Denial of Service was possible via sending crafted payloads which use AutolinkFilter to the preview_markdown endpoint. This is a high severity issue (<code>CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H</code>, 7.5). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-3364">CVE-2023-3364</a>.</p>
<p>Thanks <a href="https://hackerone.com/ryhmnlfj">ryhmnlfj</a> for reporting this vulnerability through our HackerOne bug bounty program.</p>
<h2 id=an-attacker-can-run-pipeline-jobs-as-arbitrary-user>An attacker can run pipeline jobs as arbitrary user</h2>

<p>An issue has been discovered in GitLab EE affecting all versions starting from 13.12 before 16.0.8, all versions starting from 16.1 before 16.1.3, all versions starting from 16.2 before 16.2.2. It was possible for an attacker to run pipeline jobs as an arbitrary user via scheduled security scan policies. This is a high severity issue (<code>CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:N</code>, 8.2). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-3932">CVE-2023-3932</a>.</p>
<p>Thanks <a href="https://hackerone.com/vaib25vicky">vaib25vicky</a> for reporting this vulnerability through our HackerOne bug bounty program.</p>
<h2 id=regex-dos-in-harbor-registry-search>Regex DoS in Harbor Registry search</h2>

<p>An issue has been discovered in GitLab CE/EE affecting all versions starting from 15.2 before 16.0.8, all versions starting from 16.1 before 16.1.3, all versions starting from 16.2 before 16.2.2. A Regular Expression Denial of Service was possible by using crafted payloads to search Harbor Registry. This is a medium severity issue (<code>CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H</code>, 6.5). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-0632">CVE-2023-0632</a>.</p>
<p>Thanks <a href="https://hackerone.com/joaxcar">joaxcar</a> for reporting this vulnerability through our HackerOne bug bounty program.</p>
<h2 id=arbitrary-read-of-files-owned-by-the-git-user-via-malicious-targz-file-upload-using-gitlab-export-functionality>Arbitrary read of files owned by the "git" user via malicious tar.gz file upload using GitLab export functionality</h2>

<p>An issue has been discovered in GitLab CE/EE affecting all versions starting from 8.10 before 16.0.8, all versions starting from 16.1 before 16.1.3, all versions starting from 16.2 before 16.2.2. Under specific circumstances, a user importing a project 'from export' could access and read unrelated files via uploading a specially crafted file. This was due to a bug in <code>tar</code>, fixed in <a href="https://lists.gnu.org/archive/html/info-gnu/2023-07/msg00005.html"><code>tar-1.35</code></a>. This is a medium severity issue (<code>CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:N/A:N</code>, 6.3). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-3385">CVE-2023-3385</a>.</p>
<p>Thanks <a href="https://hackerone.com/ubercomp">ubercomp</a> for reporting this vulnerability through our HackerOne bug bounty program.</p>
<h2 id=stored-xss-in-web-ide-beta-via-crafted-url>Stored XSS in Web IDE Beta via crafted URL</h2>
<p>An issue has been discovered in GitLab CE/EE affecting all versions starting from 15.9 before 16.0.8, all versions starting from 16.1 before 16.1.3, all versions starting from 16.2 before 16.2.2. It was possible for an attacker to trigger a stored XSS vulnerability via user interaction with a crafted URL in the WebIDE beta. This is a medium severity issue (<code>CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N</code>, 5.4). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-2164">CVE-2023-2164</a>.</p>
<p>Thanks <a href="https://hackerone.com/viridian_40826d">viridian_40826d</a> for reporting this vulnerability through our HackerOne bug bounty program.</p>
<h2 id=securitypolicyprojectassign-mutation-does-not-authorize-security-policy-project-id><code>securityPolicyProjectAssign</code> mutation does not authorize security policy project ID</h2>

<p>An issue has been discovered in GitLab EE affecting all versions starting from 14.1 before 16.0.8, all versions starting from 16.1 before 16.1.3, all versions starting from 16.2 before 16.2.2. It was possible for EE-licensed users to link any security policy project by its ID to projects or groups the user has access to, potentially revealing the security projects's configured security policies. This is a medium severity issue (<code>CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N</code>, 5.3). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-4002">CVE-2023-4002</a>.</p>
<p>This vulnerability has been discovered internally by GitLab team member <a href="https://gitlab.com/bauerdominic">bauerdominic</a>.</p>
<h2 id=possible-pages-unique-domain-overwrite>Possible Pages Unique Domain Overwrite</h2>

<p>An issue has been discovered in GitLab CE/EE affecting all versions starting from 15.9 before 16.0.8, all versions starting from 16.1 before 16.1.3, all versions starting from 16.2 before 16.2.2. It was possible to takeover GitLab Pages with unique domain URLs if the random string added was known. This is a medium severity issue (<code>CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:N/A:N</code>, 5.0). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-4008">CVE-2023-4008</a>.</p>
<p>This vulnerability was discovered internally by GitLab team member <a href="https://gitlab.com/kassio">kassio</a>.</p>
<h2 id=access-tokens-may-have-been-logged-when-a-query-was-made-to-an-endpoint>Access tokens may have been logged when a query was made to an endpoint</h2>

<p>An issue has been discovered in GitLab EE affecting all versions starting from 14.3 before 16.0.8, all versions starting from 16.1 before 16.1.3, all versions starting from 16.2 before 16.2.2. Access tokens may have been logged when a query was made to a specific endpoint. This is a medium severity issue (<code>CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N</code>, 4.9). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-3993">CVE-2023-3993</a>.</p>
<p>This vulnerability was discovered internally by GitLab team member <a href="https://gitlab.com/mjozenazemian">mjozenazemian</a>.</p>
<h2 id=reflected-xss-via-plantuml-diagram>Reflected XSS via PlantUML diagram</h2>

<p>An issue has been discovered in GitLab CE/EE affecting all versions starting from 10.0 before 16.0.8, all versions starting from 16.1 before 16.1.3, all versions starting from 16.2 before 16.2.2. A reflected XSS was possible when creating specific PlantUML diagrams that allowed the attacker to perform arbitrary actions on behalf of victims. This is a medium severity issue (<code>CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N</code>, 4.8). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-3500">CVE-2023-3500</a>.</p>
<p>Thanks <a href="https://hackerone.com/ankitsingh">ankitsingh</a> for reporting this vulnerability through our HackerOne bug bounty program.</p>
<h2 id=the-main-branch-of-a-repository-with-a-specially-designed-name-may-allow-an-attacker-to-create-repositories-with-malicious-code>The main branch of a repository with a specially designed name may allow an attacker to create repositories with malicious code</h2>

<p>An issue has been discovered in GitLab affecting all versions before 16.0.8, all versions starting from 16.1 before 16.1.3, all versions starting from 16.2 before 16.2.2. The main branch of a repository with a specially designed name allows an attacker to create repositories with malicious code. This is a medium severity issue (<code>CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:N/I:H/A:N</code>, 4.8). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-3401">CVE-2023-3401</a>.</p>
<p>Thanks <a href="https://hackerone.com/st4nly0n">st4nly0n</a> for reporting this vulnerability through our HackerOne bug bounty program</p>
<h2 id=invalid-start_sha-value-on-merge-requests-page-may-lead-to-denial-of-service>Invalid 'start_sha' value on merge requests page may lead to Denial of Service</h2>

<p>An issue has been discovered in GitLab CE/EE affecting all versions starting from 16.1 before 16.1.3, all versions starting from 16.2 before 16.2.2. An invalid 'start_sha' value on merge requests page may lead to Denial of Service as Changes tab would not load. This is a medium severity issue (<code>CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L</code>, 4.3). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-3900">CVE-2023-3900</a>.</p>
<p>Thanks <a href="https://hackerone.com/toukakirishima">toukakirishima</a> for reporting this vulnerability through our HackerOne bug bounty program.</p>
<h2 id=developers-can-create-pipeline-schedules-on-protected-branches-even-if-they-dont-have-access-to-merge>Developers can create pipeline schedules on protected branches even if they don't have access to merge</h2>

<p>An issue has been discovered in GitLab CE/EE affecting all versions starting before 16.0.8, all versions starting from 16.1 before 16.1.3, all versions starting from 16.2 before 16.2.2, which leads to developers being able to create pipeline schedules on protected branches even if they don't have access to merge. This is a medium severity issue (<code>CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N</code>, 4.3). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-2022">CVE-2023-2022</a>.</p>
<p>Thanks <a href="https://hackerone.com/js_noob">js_noob</a> for reporting this vulnerability through our HackerOne bug bounty program.</p>
<h2 id=potential-dos-due-to-lack-of-pagination-while-loading-license-data>Potential DOS due to lack of pagination while loading license data</h2>

<p>An issue has been discovered in GitLab EE affecting all versions from 15.11 prior to 16.2.2 which allows an attacker to spike the resource consumption by loading Dependency List page, resulting in a possible DoS. This is a medium severity issue (<code>CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L</code>, 4.3). It is mitigated in the latest 16.2.2 release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-4011">CVE-2023-4011</a>.</p>
<p>This vulnerability was discovered internally by GitLab team member <a href="https://gitlab.com/gonzoyumo">gonzoyumo</a>.</p>
<h2 id=leaking-emails-of-newly-created-users>Leaking emails of newly created users</h2>

<p>An issue has been discovered in GitLab affecting all versions starting from 12.9 before 16.0.8, all versions starting from 16.1 before 16.1.3, all versions starting from 16.2 before 16.2.2. It was possible to leak a user's email via an error message for groups that restrict membership by email domain. This is a low severity issue (<code>CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N</code>, 3.1). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-1210">CVE-2023-1210</a>.</p>
<p>Thanks <a href="https://hackerone.com/shells3c">shells3c</a> for reporting this vulnerability through our HackerOne bug bounty program.</p>
<h2 id=update-mattermost>Update Mattermost</h2>
<p>Mattermost has been updated to version 7.10.4 in order to mitigate security issues.</p>
<h2 id=update-redis>Update Redis</h2>
<p>Redis has been updated to version 6.2.13 in order to mitigate security issues.</p>
<h2 id=non-security-patches>Non Security Patches</h2>
<p>This security release also includes the following non-security patches.</p>
<h3 id=1622>16.2.2</h3>
<ul>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/127238" title="Merge branch '418983-fix-issue-type-update' into 'master'">Issue type change to incident results in 404</a></li>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/127045" title="Enable descendant_security_scans by default">Enable <code>descendant_security_scans</code> by default</a></li>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/127516" title="Disable IAT verification by default">Disable IAT verification by default</a></li>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/127777" title="BitBucket Server Importer - Preserve PR (MR) reviewers">BitBucket Server Importer - Preserve PR (MR) reviewers</a></li>
<li><a href="https://gitlab.com/gitlab-org/omnibus-gitlab/-/merge_requests/7060" title="Toggle recommend_pg_upgrade to false for now">Toggle <code>recommend_pg_upgrade</code> to false for now</a></li>
</ul>
<h3 id=1613>16.1.3</h3>
<ul>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/125261" title="Geo: Backport design repos verification bug fix">Geo: Backport design repos verification bug fix</a></li>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/125316" title="Geo - Backport wiki repository verification fix">Geo - Backport wiki repository verification fix</a></li>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/126783" title="Fix FOUC when new sidebar enabled">Fix FOUC when new sidebar enabled</a></li>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/127515" title="[16.1] Repair the trigger for Release Environments">Repair the trigger for Release Environments</a></li>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/127517" title="Disable IAT verification by default">Disable IAT verification by default</a></li>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/127402" title="Backport fix for pending direct uploads completion to 16.1">Backport fix for pending direct uploads completion to 16.1</a></li>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/127778" title="BitBucket Server Importer - Preserve PR (MR) reviewers">BitBucket Server Importer - Preserve PR (MR) reviewers</a></li>
<li><a href="https://gitlab.com/gitlab-org/omnibus-gitlab/-/merge_requests/7050" title="Fix pg-upgrade failure on Geo secondary nodes [16.1]">Fix pg-upgrade failure on Geo secondary nodes [16.1]</a></li>
<li><a href="https://gitlab.com/gitlab-org/omnibus-gitlab/-/merge_requests/7034" title="Don't 500 when pages tries to serve a chunked file">Don't 500 when pages tries to serve a chunked file</a></li>
</ul>
<h3 id=1608>16.0.8</h3>
<ul>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/127518" title="Disable IAT verification by default">Disable IAT verification by default</a></li>
<li><a href="https://gitlab.com/gitlab-org/omnibus-gitlab/-/merge_requests/7051" title="Fix pg-upgrade failure on Geo secondary nodes [16.0]">Fix pg-upgrade failure on Geo secondary nodes [16.0]</a></li>
</ul>
<h2 id=updating>Updating</h2>
<p>To update GitLab, see the <a href="/update">Update page</a>.
To update Gitlab Runner, see the <a href="https://docs.gitlab.com/runner/install/linux-repository.html#updating-the-runner">Updating the Runner page</a>.</p>
<h2 id=receive-security-release-notifications>Receive Security Release Notifications</h2>
<p>To receive security release blog notifications delivered to your inbox, visit our <a href="https://about.gitlab.com/company/contact/">contact us</a> page.
To receive release notifications via RSS, subscribe to our <a href="https://about.gitlab.com/security-releases.xml">security release RSS feed</a> or our <a href="https://about.gitlab.com/all-releases.xml">RSS feed for all releases</a>.</p>
<div class='panel panel-default twitter-block'>
<a class='twitter-block-link panel-body' href='http://twitter.com/share?text=GitLab+Security+Release%3A+16.2.2%2C+16.1.3%2C+and+16.0.8&amp;url=https://about.gitlab.com/releases/2023/08/01/security-release-gitlab-16-2-2-released/&amp;hashtags=' rel=nofollow target=_blank title='Tweet!'>
<span class='twitter-text pull-left'>
GitLab Security Release: 16.2.2, 16.1.3, and 16.0.8
</span>
<span class=click-to-tweet>
Click to tweet!
<i class='fab fa-twitter'></i>
</span>
</a>
</div>
</div>
<ul class='tag-list list-unstyled'>
<li class=tag>
<a href="/releases/tags.html#security">security</a>
</li>
</ul>
<div class=social>
<div class='share-butons clearfix'>
<a class='share-btn share-btn-facebook' href='http://www.facebook.com/sharer.php?u=https://about.gitlab.com/releases/2023/08/01/security-release-gitlab-16-2-2-released/' onclick='openSocialLink(this, 500, 400); return false;' target=_blank>
<i class='fab fa-facebook'></i>
<span class=sr-only>
Share on Facebook
</span>
</a>
<a class='share-btn share-btn-twitter' href='http://twitter.com/share?url=https://about.gitlab.com/releases/2023/08/01/security-release-gitlab-16-2-2-released/&amp;text=GitLab Security Release: 16.2.2, 16.1.3, and 16.0.8' onclick='openSocialLink(this, 500, 400); return false;' target=_blank>
<i class='fab fa-twitter'></i>
<span class=sr-only>
Share on Twitter
</span>
</a>
<a class='share-btn share-btn-linkedin' href='https://www.linkedin.com/shareArticle?mini=true&amp;url=https://about.gitlab.com/releases/2023/08/01/security-release-gitlab-16-2-2-released/&amp;title=GitLab Security Release: 16.2.2, 16.1.3, and 16.0.8&amp;summary=&amp;source=' onclick='openSocialLink(this, 500, 400); return false;' target=_blank>
<i class='fab fa-linkedin'></i>
<span class=sr-only>
Share on LinkedIn
</span>
</a>
<a class='share-btn share-btn-hackernews' href='https://news.ycombinator.com/submitlink?u=https://about.gitlab.com/releases/2023/08/01/security-release-gitlab-16-2-2-released/&amp;t=GitLab Security Release: 16.2.2, 16.1.3, and 16.0.8' onclick='openSocialLink(this, 500, 400); return false;' target=_blank>
<i class='fab fa-hacker-news'></i>
<span class=sr-only>
Share on Hacker News
</span>
</a>
</div>
</div>
<nav aria-label='Blog post pager'>
<ul class=pager>
<li class=pull-left>
<a href="/releases/2023/07/27/gitlab-15-11-13-released/" title="GitLab Patch Release: 15.11.13"><i class='fa fa-chevron-left'></i>
<span class=screen-reader-text>Previous Post:</span>
<span class=adjacent_post_title>
GitLab Patch Release: 15.11.13
</span>
</a></li>
<li class=pull-right>
<a href="/releases/2023/08/03/gitlab-16-1-4-released/" title="GitLab Patch Release: 16.1.4"><span class=screen-reader-text>Next Post:</span>
<span class=adjacent_post_title>
GitLab Patch Release: 16.1.4
</span>
<i class='fa fa-chevron-right'></i>
</a></li>
</ul>
</nav>
</div>
<div class='wrapper signup'>
<div class="panel panel-default nl panel-newsletter-signup">
<div class=row>
<div class="col-12 newsletter">
<div class=newsletter-form style="margin: 32px 0">
<span class=newsletter-preamble>
Sign up for GitLab's monthly newsletter
</span>
<script src="//page.gitlab.com/js/forms2/js/forms2.min.js"></script>
<form id=mktoForm_1077 style="display: initial"></form>
<script>

          MktoForms2.setOptions(
          {
            formXDPath : "/rs/194-VVC-221/images/marketo-xdframe-relative.html"
          });
          MktoForms2.loadForm("//page.gitlab.com", "194-VVC-221", 1077, function(form) {
            form.onSuccess(function(values, followUpUrl) {

              dataLayer.push(
              {
                'event' : 'mktoLead', 
                'mktoFormId' : form.getId(),
                'eventCallback' : function()
                {
                  form.getFormElem().hide();
                  document.getElementById('confirmform').style.display = 'block';
                }, 'eventTimeout' : 3000
              });
              return false;
            });
            function getgacid() {
              try {
                var tracker = ga.getAll()[0];
                return tracker.get('clientId');
              } catch (e) {
                return 'n/a';
              }
            }
            form.vals({
              'gacid': getgacid()
            });
          });
        </script>
<div id=confirmform class=confirm-message style="display:none;"><p>Thanks for subscribing!</p></div>
</div>
</div>
</div>
</div>
</div>
<div class=gitlab-trial>
<div class=gitlab-trial__wrapper>
<div class=gitlab-trial__left-side>
<h2>
Take GitLab for a spin
</h2>
<p>
See what your team could do with The DevSecOps Platform.
</p>
<a href="https://gitlab.com/-/trials/new?glm_content=default-saas-trial&amp;glm_source=about.gitlab.com" class="btn cta-btn" data-ga-name="free trial" data-ga-location="try partial">Get free trial</a>
</div>
<div class=gitlab-trial__right-side>
<img src="/images/cta/gitlab-enterprise-team-member-photos.png" alt=""/>
<p>
Have a question? We're here to help.
</p>
<a class=sales-cta href='https://about.gitlab.com/sales/'>
Talk to an expert
</a>
</div>
</div>
</div>
<div style='display: none'>
<a href="https://gitlab.com/-/ide/project/gitlab-com/www-gitlab-com/edit/master/-/sites/uncategorized/source/releases/posts/2023-08-01-security-release-gitlab-16-2-2-released.html.md" id=hidden-web-ide>Edit this page</a>
<a href="https://gitlab.com/gitlab-com/www-gitlab-com/blob/master/sites/uncategorized/source/releases/posts/2023-08-01-security-release-gitlab-16-2-2-released.html.md" id=hidden-page-source>View source</a>
</div>
<footer id=global-footer>
<slp-footer></slp-footer>
</footer>
<script src='/javascripts/be-footer.js?cacheBust=4cf1fb774d1'></script>
<script src="/javascripts/libs/jquery.min.js?cacheBust=4cf1fb774d1"></script>
<script src="/javascripts/libs/jquery-migrate-3.3.0.min.js?cacheBust=4cf1fb774d1"></script>
<script src="/javascripts/libs/bootstrap.min.js?cacheBust=4cf1fb774d1"></script>
<script src="/javascripts/libs/jqBootstrapValidation.js?cacheBust=4cf1fb774d1"></script>
<script src="/javascripts/scripts.js?cacheBust=4cf1fb774d1"></script>
<script>
  //<![CDATA[
    $.ajax({
      url: '//munchkin.marketo.net/munchkin.js',
      dataType: 'script',
      cache: true,
      success: function() {
        Munchkin.init('194-VVC-221');
      }
    });
  //]]>
</script>
<script defer=true src='/javascripts/cbextras.js'></script>
</div>
</body>
</html>
