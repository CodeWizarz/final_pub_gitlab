<!DOCTYPE html>
<html lang=en>
<head>
<meta charset=UTF-8 />
<meta content='width=device-width, initial-scale=1.0' name=viewport />
<meta content='default-src &#39;self&#39; https: http:; script-src &#39;self&#39; &#39;unsafe-inline&#39; &#39;unsafe-eval&#39; https: http:; style-src &#39;self&#39; &#39;unsafe-inline&#39; https: http:; object-src https: http:; base-uri &#39;self&#39;; connect-src &#39;self&#39; https: http: wss: ws:; frame-src &#39;self&#39; https: http:; img-src &#39;self&#39; https: http: data:; manifest-src &#39;self&#39;; media-src &#39;self&#39; https: http:; worker-src &#39;self&#39; https: http:;' http-equiv=Content-Security-Policy />
<meta content='index, follow' name=robots />
<title>
Summary of limited GitLab credentials exposed in an internal logging system
|
GitLab
</title>
<meta content='Some GitLab.com personal access tokens and third-party credentials were inadvertently exposed publicly. This has since been resolved and all affected users notified. Read on for more details.' name=description />
<meta content='Some GitLab.com personal access tokens and third-party credentials were inadvertently exposed publicly. This has since been resolved and all affected users notified. Read on for more details.' name='twitter:description'/>
<meta content='Some GitLab.com personal access tokens and third-party credentials were inadvertently exposed publicly. This has since been resolved and all affected users notified. Read on for more details.' property='og:description'/>
<meta content=GitLab property='og:site_name'/>
<meta content='Summary of limited GitLab credentials exposed in an internal logging system' property='og:title'/>
<meta content='https://gitlab.com/gitlab-com/www-gitlab-com/' property='og:repo'/>
<meta content='https://gitlab.com/' property='og:instance'/>
<meta content='gitlab-com/www-gitlab-com/' property='og:path'/>
<meta content='releases/posts/2018-03-26-summary-of-limited-gitlab-credentials-exposed.html.md' property='og:relative_path'/>
<meta content='sites/uncategorized/' property='og:monorepo_site_path_fragment'/>
<meta content=article property='og:type'/>
<meta content='https://about.gitlab.com/releases/2018/03/26/summary-of-limited-gitlab-credentials-exposed/' property='og:url'/>
<meta content="https://about.gitlab.com/images/default-blog-image.png" property="og:image">
<meta content="https://about.gitlab.com/images/default-blog-image.png" name="twitter:image">
<meta content=summary_large_image name='twitter:card'/>
<meta content='@GitLab' name='twitter:site'/>
<meta content='Summary of limited GitLab credentials exposed in an internal logging system' name='twitter:title'/>
<meta content='@GitLab' name='twitter:creator'/>
<link href='/atom.xml' rel=alternate title=Blog type='application/atom+xml'/>
<link href='/all-releases.xml' rel=alternate title='All Releases' type='application/atom+xml'/>
<link href='/security-releases.xml' rel=alternate title='Security Releases' type='application/atom+xml'/>
<link href='/releases.xml' rel=alternate title='Major Releases' type='application/atom+xml'/>
<link href='/ico/favicon.ico?cache=2022041' rel='shortcut icon'/>
<link href='/ico/favicon-192x192.png?cache=2022041' rel=icon sizes=192x192 type='image/png'/>
<link href='/ico/favicon-160x160.png?cache=2022041' rel=icon sizes=160x160 type='image/png'/>
<link href='/ico/favicon-96x96.png?cache=2022041' rel=icon sizes=96x96 type='image/png'/>
<link href='/ico/favicon-16x16.png?cache=2022041' rel=icon sizes=16x16 type='image/png'/>
<link href='/ico/favicon-32x32.png?cache=2022041' rel=icon sizes=32x32 type='image/png'/>
<link href='/ico/apple-touch-icon-57x57.png?cache=2022041' rel=apple-touch-icon sizes=57x57 />
<link href='/ico/apple-touch-icon-114x114.png?cache=2022041' rel=apple-touch-icon sizes=114x114 />
<link href='/ico/apple-touch-icon-72x72.png?cache=2022041' rel=apple-touch-icon sizes=72x72 />
<link href='/ico/apple-touch-icon-144x144.png?cache=2022041' rel=apple-touch-icon sizes=144x144 />
<link href='/ico/apple-touch-icon-60x60.png?cache=2022041' rel=apple-touch-icon sizes=60x60 />
<link href='/ico/apple-touch-icon-120x120.png?cache=2022041' rel=apple-touch-icon sizes=120x120 />
<link href='/ico/apple-touch-icon-76x76.png?cache=2022041' rel=apple-touch-icon sizes=76x76 />
<link href='/ico/apple-touch-icon-152x152.png?cache=2022041' rel=apple-touch-icon sizes=152x152 />
<link href='/ico/apple-touch-icon-180x180.png?cache=2022041' rel=apple-touch-icon sizes=180x180 />
<meta content='#554488' name=msapplication-TileColor />
<meta content='/ico/mstile-144x144.png?cache=2022041' name=msapplication-TileImage />
<meta content='/ico/browserconfig.xml' name=msapplication-config />
<script src='https://cdn.cookielaw.org/consent/7f944245-c5cd-4eed-a90e-dd955adfdd08/OtAutoBlock.js'></script>
<script charset=UTF-8 data-domain-script=7f944245-c5cd-4eed-a90e-dd955adfdd08 src='https://cdn.cookielaw.org/scripttemplates/otSDKStub.js'></script>
<script>
  //<![CDATA[
    function OptanonWrapper() { }
  //]]>
</script>
<script>
  //<![CDATA[
    window.dataLayer = window.dataLayer || []
    function gtag(){dataLayer.push(arguments);}
    gtag('consent', 'default', {
      'analytics_storage': 'denied',
      'ad_storage': 'denied',
      'functionality_storage': 'denied',
      'region': [ 'AT', 'BE', 'BG', 'HR', 'CY', 'CZ', 'DK', 'EE', 'FI', 'FR', 'DE', 'GR', 'HU', 'IE', 'IT', 'LV', 'LT', 'LU', 'MT', 'NL', 'PL', 'PT', 'RO', 'SK', 'SI', 'ES', 'SE', 'IS', 'LI', 'NO', 'GB', 'PE', 'RU'],
      'wait_for_update': 500
    });
    gtag('consent', 'default', {
      'analytics_storage': 'granted',
      'ad_storage': 'granted',
      'functionality_storage': 'granted',
      'wait_for_update': 500
    });
    
    window.geofeed = (options) => {
      dataLayer.push({
        'event' : 'OneTrustCountryLoad',
        'oneTrustCountryId': options.country.toString()
      })
    }
    
    const json = document.createElement('script');
    json.setAttribute('src', 'https://geolocation.onetrust.com/cookieconsentpub/v1/geo/location/geofeed');
    document.head.appendChild(json);
  //]]>
</script>
<script>document.documentElement.className = 'html--js'</script>
<script async='' src='//cdn.bizible.com/scripts/bizible.js'></script>
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-37019925-1', 'auto', {allowLinker: true});
ga('require', 'GTM-WC3ZR2P');
</script>
<script>
(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NJXWQL');
</script>
<script>
(function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
(w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
})(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');
_st('install','5geYbhTxNzL5dsekC-B-','2.0.0');
</script>
<link href='https://about.gitlab.com/releases/2018/03/26/summary-of-limited-gitlab-credentials-exposed/' rel=canonical />
<link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,500,600,700' rel=stylesheet />
<link crossorigin=anonymous href='https://use.fontawesome.com/releases/v5.1.0/css/all.css' integrity='sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt' rel=stylesheet />
<link href='https://cdnjs.cloudflare.com/ajax/libs/tiny-slider/2.8.7/tiny-slider.css' rel=stylesheet />
<link href="/stylesheets/styles.css" rel=stylesheet /><link href="/stylesheets/highlight.css" rel=stylesheet />

<link href="/stylesheets/slippers.css?cacheBust=4cf1fb774d1" rel=stylesheet />
<link href="/stylesheets/be-navigation.css?cacheBust=4cf1fb774d1" rel=stylesheet />
<script>
dataLayer.push({'tags': ["security"]});
</script>
<script>
dataLayer.push({'category': 'releases'});
</script>
</head>
<body data-spy=scroll data-target='.qnav'>
<noscript>
<iframe height=0 src='//www.googletagmanager.com/ns.html?id=GTM-NJXWQL' style='display:none;visibility:hidden' width=0></iframe>
</noscript>
<template id=be-nav>
<div id=be-nav-target>
<slp-navigation></slp-navigation>
</div>
</template>
<nav class='slp-sticky slp-left-0 slp-right-0 slp-top-0 slp-bg-white slp-z-90' id=global-nav style='z-index: 1000000;'>
<be-navigation></be-navigation>
</nav>
<div class='search-box js-search-box'>
<i class='fa fa-search search-box-icon'></i>
<input class='search-input js-search st-header' placeholder='Search...'/>
<button aria-label='Close search' class='search-close js-search-toggle' type=button>
<i class='fa fa-times'></i>
</button>
</div>
<script src='/javascripts/be-navigation.js?cacheBust=4cf1fb774d1'></script>
<div class='blog article'>
<div class='wrapper body'>
<div class=category-back-link>
<a href="/releases/categories/releases/"><span>&#8592;</span>
<span>Back to</span>
<span>releases</span>
</a></div>
<span class=date>
Mar 26, 2018
</span>
<span>-</span>
<span class=author>
<a href="/company/team/#gitlab">Kathy Wang</a>
<a href="https://gitlab.com/kwang"><span>&nbsp;</span>
<span class=author-gitlab>
<i class='fab fa-gitlab'></i>
</span>
</a><a href="https://twitter.com/gitlab"><span>&nbsp;</span>
<span class=author-twitter>
<i class='fab fa-twitter'></i>
</span>
</a></span>
<h1>
Summary of limited GitLab credentials exposed in an internal logging system
</h1>
<p class=description>
Some GitLab.com personal access tokens and third-party credentials were inadvertently exposed publicly. This has since been resolved and all affected users notified. Read on for more details.
</p>
<p></p>
<div class=content>
<h2 id=summary>Summary</h2>
<p>From February 19, 2018 to March 19, 2018, some GitLab.com personal access tokens and third-party credentials were inadvertently exposed publicly via an unprotected logging dashboard. The affected users represent approximately 0.5 percent of our GitLab.com user base. While the dashboard was originally protected from unauthorized access, a recent configuration change made this internal system publically accessible.</p>
<p>Upon further review, we discovered a limited number of tokens and third-party credentials were incorrectly stored in this system. We’ve already mitigated all issues that led to this exposure. Our audit logs only cover a portion of the time the dashboard was exposed, but only one login resulted in a deep query that resulted in a personal access token being exposed. This activity was positively linked to the user that immediately disclosed the issue to us. As such, we have no evidence that any of the affected credentials were used in a malicious manner.</p>
<p>We have notified the affected users via email to update their credentials and are implementing a series of security enhancements to prevent such issues from happening again. Note that self-managed GitLab customers are entirely unaffected, as their credentials are stored in their own database and this logging functionality is off by default in self-managed instances.</p>
<h2 id=credentials-written-to-logs>Credentials written to logs</h2>
<p>On February 28, 2018 we discovered internally that GitLab’s Gitaly service was, in certain circumstances, mishandling the sanitization of private third-party credentials for push-mirrored and imported repositories. These unscrubbed credentials were then sent to our logging system (ELK) and our exception management system (Sentry).</p>
<p>During the investigation, we realized that some other credentials were also leaking into our HAProxy load balancers logs. These were personal access tokens used for GitLab API access when passed via query parameters in an HTTP request. Additionally, credentials that allow access to some third-party Git repositories were leaked into the logs. These have been fixed in the following:</p>
<ul>
<li><a href="https://gitlab.com/gitlab-org/gitaly/merge_requests/624">Sanitize URLs before logging them</a></li>
<li><a href="https://gitlab.com/gitlab-cookbooks/gitlab_fluentd/merge_requests/7">Sanitize private_token field in HA Proxy logs</a></li>
<li><a href="https://gitlab.com/gitlab-cookbooks/gitlab-oauth2-proxy/merge_requests/10">Reconfigure OAuth mechanism, removing ‘*’ email domain access</a></li>
</ul>
<h2 id=exposure-of-logs>Exposure of logs</h2>
<p>On March 19, 2018, GitLab user Ryan Hefner discovered an authentication misconfiguration on our internal logging dashboard. A configuration change was made incorrectly on February 19, 2018, which resulted in potential public read-only access to the centralized, internal logging server for GitLab. This misconfiguration was resolved immediately upon notification.</p>
<p>GitLab uses an OAuth proxy service to authenticate all access to our internal logging infrastructure. Previously, this proxy service had been correctly configured to only allow access to authorized GitLab engineers. However, in the course of migrating this proxy service to our new cloud infrastructure, we inadvertently introduced a misconfiguration that allowed anyone with a valid Google account read-only access to our internal logging server, instead of the intended behavior of allowing only authorized GitLab engineering accounts.</p>
<h2 id=impact>Impact</h2>
<p>There is no evidence of user credential abuse. However, the audit logs for the dashboard only cover seven of the 30 days in question. The only audit log activity accessing sensitive information was from the user that immediately reported the issue to GitLab. We found no evidence of abuse against the API itself. Regardless, we are taking every precaution, and strongly recommending all affected Gitlab.com users rotate their personal access tokens. Affected users have received further instructions via email notifications, accordingly.</p>
<p>Although there is no evidence to suggest it happened, in the worst case an attacker could have gained access and obtained personal access tokens used in API calls between February 19, 2018 and March 19, 2018.</p>
<h2 id=mitigations>Mitigations</h2>
<p>Since the discovery, we have worked to investigate and mitigate all of these related security issues. We are continually improving our security processes and logging mechanisms to ensure that similar incidents will not occur again. These improvements are:</p>
<ul>
<li>Increase logging retention periods</li>
<li>Fine-grain access controls to all logging infrastructure</li>
<li>Regular, periodic audits of all our logs</li>
<li>Adding mandatory review of any security-relevant changes by a GitLab Application Security engineer</li>
<li>Document this process in our runbooks to ensure repeatability</li>
<li>An additional measure we won't disclose because informing adversaries could render it less effective</li>
</ul>
<p>If your project or account is affected by this security issue, you will receive an email notification listing affected projects with steps to rotate your personal access tokens. To proactively change them visit this page: <a href="https://gitlab.com/profile/personal_access_tokens">https://gitlab.com/profile/personal_access_tokens</a>.</p>
<p>We apologize for the impact this issue has caused our users. GitLab takes your information and your data extremely seriously. We have quadrupled the size of our internal security team in the last six months and have further plans to grow. We will learn from this incident and use it to improve upon our security even further.</p>
<p>In keeping with our company value of transparency we also believe in communicating about such incidents clearly and promptly. If you have any questions, please contact <a href="&#109;&#097;&#105;&#108;&#116;&#111;:&#115;&#101;&#099;&#117;&#114;&#105;&#116;&#121;&#064;&#103;&#105;&#116;&#108;&#097;&#098;&#046;&#099;&#111;&#109;">&#115;&#101;&#099;&#117;&#114;&#105;&#116;&#121;&#064;&#103;&#105;&#116;&#108;&#097;&#098;&#046;&#099;&#111;&#109;</a>.</p>
<div class='panel panel-default twitter-block'>
<a class='twitter-block-link panel-body' href='http://twitter.com/share?text=Summary+of+limited+GitLab+credentials+exposed+in+an+internal+logging+system+via+%40gitlab&amp;url=https://about.gitlab.com/releases/2018/03/26/summary-of-limited-gitlab-credentials-exposed/&amp;hashtags=' rel=nofollow target=_blank title='Tweet!'>
<span class='twitter-text pull-left'>
Summary of limited GitLab credentials exposed in an internal logging system
via @gitlab
</span>
<span class=click-to-tweet>
Click to tweet!
<i class='fab fa-twitter'></i>
</span>
</a>
</div>
</div>
<ul class='tag-list list-unstyled'>
<li class=tag>
<a href="/releases/tags.html#security">security</a>
</li>
</ul>
<div class=social>
<div class='share-butons clearfix'>
<a class='share-btn share-btn-facebook' href='http://www.facebook.com/sharer.php?u=https://about.gitlab.com/releases/2018/03/26/summary-of-limited-gitlab-credentials-exposed/' onclick='openSocialLink(this, 500, 400); return false;' target=_blank>
<i class='fab fa-facebook'></i>
<span class=sr-only>
Share on Facebook
</span>
</a>
<a class='share-btn share-btn-twitter' href='http://twitter.com/share?url=https://about.gitlab.com/releases/2018/03/26/summary-of-limited-gitlab-credentials-exposed/&amp;text=Summary of limited GitLab credentials exposed in an internal logging system' onclick='openSocialLink(this, 500, 400); return false;' target=_blank>
<i class='fab fa-twitter'></i>
<span class=sr-only>
Share on Twitter
</span>
</a>
<a class='share-btn share-btn-linkedin' href='https://www.linkedin.com/shareArticle?mini=true&amp;url=https://about.gitlab.com/releases/2018/03/26/summary-of-limited-gitlab-credentials-exposed/&amp;title=Summary of limited GitLab credentials exposed in an internal logging system&amp;summary=&amp;source=' onclick='openSocialLink(this, 500, 400); return false;' target=_blank>
<i class='fab fa-linkedin'></i>
<span class=sr-only>
Share on LinkedIn
</span>
</a>
<a class='share-btn share-btn-hackernews' href='https://news.ycombinator.com/submitlink?u=https://about.gitlab.com/releases/2018/03/26/summary-of-limited-gitlab-credentials-exposed/&amp;t=Summary of limited GitLab credentials exposed in an internal logging system' onclick='openSocialLink(this, 500, 400); return false;' target=_blank>
<i class='fab fa-hacker-news'></i>
<span class=sr-only>
Share on Hacker News
</span>
</a>
</div>
</div>
<nav aria-label='Blog post pager'>
<ul class=pager>
<li class=pull-left>
<a href="/releases/2018/03/22/gitlab-10-6-released/" title="GitLab 10.6 released with CI/CD for GitHub and deeper Kubernetes integration"><i class='fa fa-chevron-left'></i>
<span class=screen-reader-text>Previous Post:</span>
<span class=adjacent_post_title>
GitLab 10.6 released with CI/CD for GitHub and
...
</span>
</a></li>
<li class=pull-right>
<a href="/releases/2018/03/28/gitlab-10-6-1-released/" title="GitLab Patch Release: 10.6.1"><span class=screen-reader-text>Next Post:</span>
<span class=adjacent_post_title>
GitLab Patch Release: 10.6.1
</span>
<i class='fa fa-chevron-right'></i>
</a></li>
</ul>
</nav>
</div>
<div class='wrapper signup'>
<div class="panel panel-default nl panel-newsletter-signup">
<div class=row>
<div class="col-12 newsletter">
<div class=newsletter-form style="margin: 32px 0">
<span class=newsletter-preamble>
Sign up for GitLab's monthly newsletter
</span>
<script src="//page.gitlab.com/js/forms2/js/forms2.min.js"></script>
<form id=mktoForm_1077 style="display: initial"></form>
<script>

          MktoForms2.setOptions(
          {
            formXDPath : "/rs/194-VVC-221/images/marketo-xdframe-relative.html"
          });
          MktoForms2.loadForm("//page.gitlab.com", "194-VVC-221", 1077, function(form) {
            form.onSuccess(function(values, followUpUrl) {

              dataLayer.push(
              {
                'event' : 'mktoLead', 
                'mktoFormId' : form.getId(),
                'eventCallback' : function()
                {
                  form.getFormElem().hide();
                  document.getElementById('confirmform').style.display = 'block';
                }, 'eventTimeout' : 3000
              });
              return false;
            });
            function getgacid() {
              try {
                var tracker = ga.getAll()[0];
                return tracker.get('clientId');
              } catch (e) {
                return 'n/a';
              }
            }
            form.vals({
              'gacid': getgacid()
            });
          });
        </script>
<div id=confirmform class=confirm-message style="display:none;"><p>Thanks for subscribing!</p></div>
</div>
</div>
</div>
</div>
</div>
<div class=gitlab-trial>
<div class=gitlab-trial__wrapper>
<div class=gitlab-trial__left-side>
<h2>
Take GitLab for a spin
</h2>
<p>
See what your team could do with The DevSecOps Platform.
</p>
<a href="https://gitlab.com/-/trials/new?glm_content=default-saas-trial&amp;glm_source=about.gitlab.com" class="btn cta-btn" data-ga-name="free trial" data-ga-location="try partial">Get free trial</a>
</div>
<div class=gitlab-trial__right-side>
<img src="/images/cta/gitlab-enterprise-team-member-photos.png" alt=""/>
<p>
Have a question? We're here to help.
</p>
<a class=sales-cta href='https://about.gitlab.com/sales/'>
Talk to an expert
</a>
</div>
</div>
</div>
<div style='display: none'>
<a href="https://gitlab.com/-/ide/project/gitlab-com/www-gitlab-com/edit/master/-/sites/uncategorized/source/releases/posts/2018-03-26-summary-of-limited-gitlab-credentials-exposed.html.md" id=hidden-web-ide>Edit this page</a>
<a href="https://gitlab.com/gitlab-com/www-gitlab-com/blob/master/sites/uncategorized/source/releases/posts/2018-03-26-summary-of-limited-gitlab-credentials-exposed.html.md" id=hidden-page-source>View source</a>
</div>
<footer id=global-footer>
<slp-footer></slp-footer>
</footer>
<script src='/javascripts/be-footer.js?cacheBust=4cf1fb774d1'></script>
<script src="/javascripts/libs/jquery.min.js?cacheBust=4cf1fb774d1"></script>
<script src="/javascripts/libs/jquery-migrate-3.3.0.min.js?cacheBust=4cf1fb774d1"></script>
<script src="/javascripts/libs/bootstrap.min.js?cacheBust=4cf1fb774d1"></script>
<script src="/javascripts/libs/jqBootstrapValidation.js?cacheBust=4cf1fb774d1"></script>
<script src="/javascripts/scripts.js?cacheBust=4cf1fb774d1"></script>
<script>
  //<![CDATA[
    $.ajax({
      url: '//munchkin.marketo.net/munchkin.js',
      dataType: 'script',
      cache: true,
      success: function() {
        Munchkin.init('194-VVC-221');
      }
    });
  //]]>
</script>
<script defer=true src='/javascripts/cbextras.js'></script>
</div>
</body>
</html>
