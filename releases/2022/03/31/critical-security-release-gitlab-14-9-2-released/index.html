<!DOCTYPE html>
<html lang=en>
<head>
<meta charset=UTF-8 />
<meta content='width=device-width, initial-scale=1.0' name=viewport />
<meta content='default-src &#39;self&#39; https: http:; script-src &#39;self&#39; &#39;unsafe-inline&#39; &#39;unsafe-eval&#39; https: http:; style-src &#39;self&#39; &#39;unsafe-inline&#39; https: http:; object-src https: http:; base-uri &#39;self&#39;; connect-src &#39;self&#39; https: http: wss: ws:; frame-src &#39;self&#39; https: http:; img-src &#39;self&#39; https: http: data:; manifest-src &#39;self&#39;; media-src &#39;self&#39; https: http:; worker-src &#39;self&#39; https: http:;' http-equiv=Content-Security-Policy />
<meta content='index, follow' name=robots />
<title>
GitLab Critical Security Release: 14.9.2, 14.8.5, and 14.7.7
|
GitLab
</title>
<meta content='Learn more about GitLab Critical Security Release: 14.9.2, 14.8.5, and 14.7.7 for GitLab Community Edition (CE) and Enterprise Edition (EE).' name=description />
<meta content='Learn more about GitLab Critical Security Release: 14.9.2, 14.8.5, and 14.7.7 for GitLab Community Edition (CE) and Enterprise Edition (EE).' name='twitter:description'/>
<meta content='Learn more about GitLab Critical Security Release: 14.9.2, 14.8.5, and 14.7.7 for GitLab Community Edition (CE) and Enterprise Edition (EE).' property='og:description'/>
<meta content=GitLab property='og:site_name'/>
<meta content='GitLab Critical Security Release: 14.9.2, 14.8.5, and 14.7.7' property='og:title'/>
<meta content='https://gitlab.com/gitlab-com/www-gitlab-com/' property='og:repo'/>
<meta content='https://gitlab.com/' property='og:instance'/>
<meta content='gitlab-com/www-gitlab-com/' property='og:path'/>
<meta content='releases/posts/2022-03-31-critical-security-release-gitlab-14-9-2-released.html.md' property='og:relative_path'/>
<meta content='sites/uncategorized/' property='og:monorepo_site_path_fragment'/>
<meta content=article property='og:type'/>
<meta content='https://about.gitlab.com/releases/2022/03/31/critical-security-release-gitlab-14-9-2-released/' property='og:url'/>
<meta content="https://about.gitlab.com/images/blogimages/security-cover-new.png" property="og:image">
<meta content="https://about.gitlab.com/images/blogimages/security-cover-new.png" name="twitter:image">
<meta content=summary_large_image name='twitter:card'/>
<meta content='@GitLab' name='twitter:site'/>
<meta content='GitLab Critical Security Release: 14.9.2, 14.8.5, and 14.7.7' name='twitter:title'/>
<meta content='@GitLab' name='twitter:creator'/>
<link href='/atom.xml' rel=alternate title=Blog type='application/atom+xml'/>
<link href='/all-releases.xml' rel=alternate title='All Releases' type='application/atom+xml'/>
<link href='/security-releases.xml' rel=alternate title='Security Releases' type='application/atom+xml'/>
<link href='/releases.xml' rel=alternate title='Major Releases' type='application/atom+xml'/>
<link href='/ico/favicon.ico?cache=2022041' rel='shortcut icon'/>
<link href='/ico/favicon-192x192.png?cache=2022041' rel=icon sizes=192x192 type='image/png'/>
<link href='/ico/favicon-160x160.png?cache=2022041' rel=icon sizes=160x160 type='image/png'/>
<link href='/ico/favicon-96x96.png?cache=2022041' rel=icon sizes=96x96 type='image/png'/>
<link href='/ico/favicon-16x16.png?cache=2022041' rel=icon sizes=16x16 type='image/png'/>
<link href='/ico/favicon-32x32.png?cache=2022041' rel=icon sizes=32x32 type='image/png'/>
<link href='/ico/apple-touch-icon-57x57.png?cache=2022041' rel=apple-touch-icon sizes=57x57 />
<link href='/ico/apple-touch-icon-114x114.png?cache=2022041' rel=apple-touch-icon sizes=114x114 />
<link href='/ico/apple-touch-icon-72x72.png?cache=2022041' rel=apple-touch-icon sizes=72x72 />
<link href='/ico/apple-touch-icon-144x144.png?cache=2022041' rel=apple-touch-icon sizes=144x144 />
<link href='/ico/apple-touch-icon-60x60.png?cache=2022041' rel=apple-touch-icon sizes=60x60 />
<link href='/ico/apple-touch-icon-120x120.png?cache=2022041' rel=apple-touch-icon sizes=120x120 />
<link href='/ico/apple-touch-icon-76x76.png?cache=2022041' rel=apple-touch-icon sizes=76x76 />
<link href='/ico/apple-touch-icon-152x152.png?cache=2022041' rel=apple-touch-icon sizes=152x152 />
<link href='/ico/apple-touch-icon-180x180.png?cache=2022041' rel=apple-touch-icon sizes=180x180 />
<meta content='#554488' name=msapplication-TileColor />
<meta content='/ico/mstile-144x144.png?cache=2022041' name=msapplication-TileImage />
<meta content='/ico/browserconfig.xml' name=msapplication-config />
<script src='https://cdn.cookielaw.org/consent/7f944245-c5cd-4eed-a90e-dd955adfdd08/OtAutoBlock.js'></script>
<script charset=UTF-8 data-domain-script=7f944245-c5cd-4eed-a90e-dd955adfdd08 src='https://cdn.cookielaw.org/scripttemplates/otSDKStub.js'></script>
<script>
  //<![CDATA[
    function OptanonWrapper() { }
  //]]>
</script>
<script>
  //<![CDATA[
    window.dataLayer = window.dataLayer || []
    function gtag(){dataLayer.push(arguments);}
    gtag('consent', 'default', {
      'analytics_storage': 'denied',
      'ad_storage': 'denied',
      'functionality_storage': 'denied',
      'region': [ 'AT', 'BE', 'BG', 'HR', 'CY', 'CZ', 'DK', 'EE', 'FI', 'FR', 'DE', 'GR', 'HU', 'IE', 'IT', 'LV', 'LT', 'LU', 'MT', 'NL', 'PL', 'PT', 'RO', 'SK', 'SI', 'ES', 'SE', 'IS', 'LI', 'NO', 'GB', 'PE', 'RU'],
      'wait_for_update': 500
    });
    gtag('consent', 'default', {
      'analytics_storage': 'granted',
      'ad_storage': 'granted',
      'functionality_storage': 'granted',
      'wait_for_update': 500
    });
    
    window.geofeed = (options) => {
      dataLayer.push({
        'event' : 'OneTrustCountryLoad',
        'oneTrustCountryId': options.country.toString()
      })
    }
    
    const json = document.createElement('script');
    json.setAttribute('src', 'https://geolocation.onetrust.com/cookieconsentpub/v1/geo/location/geofeed');
    document.head.appendChild(json);
  //]]>
</script>
<script>document.documentElement.className = 'html--js'</script>
<script async='' src='//cdn.bizible.com/scripts/bizible.js'></script>
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-37019925-1', 'auto', {allowLinker: true});
ga('require', 'GTM-WC3ZR2P');
</script>
<script>
(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NJXWQL');
</script>
<script>
(function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
(w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
})(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');
_st('install','5geYbhTxNzL5dsekC-B-','2.0.0');
</script>
<link href='https://about.gitlab.com/releases/2022/03/31/critical-security-release-gitlab-14-9-2-released/' rel=canonical />
<link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,500,600,700' rel=stylesheet />
<link crossorigin=anonymous href='https://use.fontawesome.com/releases/v5.1.0/css/all.css' integrity='sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt' rel=stylesheet />
<link href='https://cdnjs.cloudflare.com/ajax/libs/tiny-slider/2.8.7/tiny-slider.css' rel=stylesheet />
<link href="/stylesheets/styles.css" rel=stylesheet /><link href="/stylesheets/highlight.css" rel=stylesheet />

<link href="/stylesheets/slippers.css?cacheBust=4cf1fb774d1" rel=stylesheet />
<link href="/stylesheets/be-navigation.css?cacheBust=4cf1fb774d1" rel=stylesheet />
<script>
dataLayer.push({'tags': ["security"]});
</script>
<script>
dataLayer.push({'category': 'releases'});
</script>
</head>
<body data-spy=scroll data-target='.qnav'>
<noscript>
<iframe height=0 src='//www.googletagmanager.com/ns.html?id=GTM-NJXWQL' style='display:none;visibility:hidden' width=0></iframe>
</noscript>
<template id=be-nav>
<div id=be-nav-target>
<slp-navigation></slp-navigation>
</div>
</template>
<nav class='slp-sticky slp-left-0 slp-right-0 slp-top-0 slp-bg-white slp-z-90' id=global-nav style='z-index: 1000000;'>
<be-navigation></be-navigation>
</nav>
<div class='search-box js-search-box'>
<i class='fa fa-search search-box-icon'></i>
<input class='search-input js-search st-header' placeholder='Search...'/>
<button aria-label='Close search' class='search-close js-search-toggle' type=button>
<i class='fa fa-times'></i>
</button>
</div>
<script src='/javascripts/be-navigation.js?cacheBust=4cf1fb774d1'></script>
<div class='blog article'>
<div class='wrapper body'>
<div class=category-back-link>
<a href="/releases/categories/releases/"><span>&#8592;</span>
<span>Back to</span>
<span>releases</span>
</a></div>
<span class=date>
Mar 31, 2022
</span>
<span>-</span>
<span class=author>
<a href="/company/team/#dcouture">Dominic Couture</a>
<a href="https://gitlab.com/dcouture"><span>&nbsp;</span>
<span class=author-gitlab>
<i class='fab fa-gitlab'></i>
</span>
</a></span>
<h1>
GitLab Critical Security Release: 14.9.2, 14.8.5, and 14.7.7
</h1>
<p class=description>
Learn more about GitLab Critical Security Release: 14.9.2, 14.8.5, and 14.7.7 for GitLab Community Edition (CE) and Enterprise Edition (EE).
</p>
<p></p>
<div class=cover style='background-image: url(/images/blogimages/security-cover-new.png);'></div>
<div class=content>
<p><strong>Updated 14:50 UTC 2022-04-01</strong> We have updated this blog post with <a href="#script-to-identify-users-potentially-impacted-by-cve-2022-1162">a script to be used by self-managed instance admins to identify user accounts potentially impacted by CVE-2022-1162</a>.</p>
<p>Today we are releasing versions 14.9.2, 14.8.5, and 14.7.7 for GitLab Community Edition (CE) and Enterprise Edition (EE). <em>Please note, this critical release will also serve as our monthly security release for March.</em></p>
<h3 id=we-strongly-recommend-that-all-gitlab-installations-be-upgraded-to-one-of-these-versions-immediately>We strongly recommend that all GitLab installations be upgraded to one of these versions immediately.</h3>
<p>These versions contain important security fixes. GitLab.com is already running the patched version.</p>
<p>GitLab releases patches for vulnerabilities in dedicated security releases. There are two types of security releases: a monthly, scheduled security release, released a week after the feature release (which deploys on the 22nd of each month), and ad-hoc security releases for critical vulnerabilities. For more information, you can visit our <a href="https://about.gitlab.com/security/faq/">security FAQ</a>. You can see all of our regular and security release blog posts <a href="/releases/categories/releases/">here</a>. In addition, the issues detailing each vulnerability are made public on our <a href="https://gitlab.com/gitlab-org/gitlab/issues?label_name%5B%5D=security&amp;scope=all&amp;state=opened">issue tracker</a> 30 days after the release in which they were patched.</p>
<p>We are dedicated to ensuring all aspects of GitLab that are exposed to customers or that host customer data are held to the highest security standards. As part of maintaining good security hygiene, it is highly recommended that all customers upgrade to the latest security release for their supported version. You can read more <a href="/blog/2020/05/20/gitlab-instance-security-best-practices/">best practices in securing your GitLab instance</a> in our blog post.</p>
<h3 id=recommended-action>Recommended Action</h3>
<p>We <strong>strongly recommend</strong> that all installations running a version affected by the issues described below are <strong>upgraded to the latest version as soon as possible</strong>.</p>
<p>When no specific deployment type (omnibus, source code, helm chart, etc.) of a product is mentioned, this means all types are affected.</p>
<h2 id=table-of-fixes>Table of Fixes</h2>
<table>
<thead>
<tr>
<th>Title</th>
<th>Severity</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#static-passwords-inadvertently-set-during-omniauth-based-registration">Static passwords inadvertently set during OmniAuth-based registration</a></td>
<td>critical</td>
</tr>
<tr>
<td><a href="#stored-xss-in-notes">Stored XSS in notes</a></td>
<td>high</td>
</tr>
<tr>
<td><a href="#stored-xss-on-multi-word-milestone-reference">Stored XSS on Multi-word milestone reference</a></td>
<td>high</td>
</tr>
<tr>
<td><a href="#denial-of-service-caused-by-a-specially-crafted-rdoc-file">Denial of service caused by a specially crafted RDoc file</a></td>
<td>medium</td>
</tr>
<tr>
<td><a href="#gitlab-pages-access-tokens-can-be-reused-on-multiple-domains">GitLab Pages access tokens can be reused on multiple domains</a></td>
<td>medium</td>
</tr>
<tr>
<td><a href="#gitlab-pages-uses-default-disabled-server-timeouts-and-a-weak-tcp-keep-alive-timeout">GitLab Pages uses default (disabled) server Timeouts and a weak TCP Keep-Alive timeout</a></td>
<td>medium</td>
</tr>
<tr>
<td><a href="#incorrect-include-in-pipeline-definition-exposes-masked-ci-variables-in-ui">Incorrect include in pipeline definition exposes masked CI variables in UI</a></td>
<td>medium</td>
</tr>
<tr>
<td><a href="#regular-expression-denial-of-service-in-release-asset-link">Regular expression denial of service in release asset link</a></td>
<td>medium</td>
</tr>
<tr>
<td><a href="#latest-commit-details-from-private-projects-leaked-to-guest-users-via-merge-requests">Latest Commit details from private projects leaked to guest users via Merge Requests</a></td>
<td>medium</td>
</tr>
<tr>
<td><a href="#cicd-analytics-are-available-even-when-public-pipelines-are-disabled">CI/CD analytics are available even when public pipelines are disabled</a></td>
<td>medium</td>
</tr>
<tr>
<td><a href="#absence-of-limit-for-the-number-of-tags-that-can-be-added-to-a-runner-can-cause-performance-issues">Absence of limit for the number of tags that can be added to a runner can cause performance issues</a></td>
<td>medium</td>
</tr>
<tr>
<td><a href="#client-dos-through-rendering-crafted-comments">Client DoS through rendering crafted comments</a></td>
<td>medium</td>
</tr>
<tr>
<td><a href="#blind-ssrf-through-repository-mirroring">Blind SSRF Through Repository Mirroring</a></td>
<td>low</td>
</tr>
<tr>
<td><a href="#bypass-of-branch-restriction-in-asana-integration">Bypass of branch restriction in Asana integration</a></td>
<td>low</td>
</tr>
<tr>
<td><a href="#readable-approval-rules-by-guest-user">Readable approval rules by Guest user</a></td>
<td>low</td>
</tr>
<tr>
<td><a href="#redact-invalidurierror-error-messages">Redact InvalidURIError error messages</a></td>
<td>low</td>
</tr>
<tr>
<td><a href="#project-import-maps-members-created_by_id-users-based-on-source-user-id">Project import maps members' created_by_id users based on source user ID</a></td>
<td>low</td>
</tr>
</tbody>
</table>
<h2 id=static-passwords-inadvertently-set-during-omniauth-based-registration>Static passwords inadvertently set during OmniAuth-based registration</h2>
<p>A hardcoded password was set for accounts registered using an OmniAuth provider (e.g. OAuth, LDAP, SAML) in GitLab CE/EE versions 14.7 prior to 14.7.7, 14.8 prior to 14.8.5, and 14.9 prior to 14.9.2 allowing attackers to potentially take over accounts. This is a critical severity issue (<code>CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N</code>, 9.1). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1162">CVE-2022-1162</a>.</p>
<p>This vulnerability has been discovered internally by the GitLab team.</p>
<p><strong><em>Note:</em></strong> We executed a reset of GitLab.com passwords for a selected set of users as of 15:38 UTC. Our investigation shows no indication that users or accounts have been compromised but we’re taking precautionary measures for our users’ security.</p>
<h2 id=stored-xss-in-notes>Stored XSS in notes</h2>
<p>Improper neutralization of user input in GitLab CE/EE versions 14.4 before 14.7.7, all versions starting from 14.8 before 14.8.5, all versions starting from 14.9 before 14.9.2 allowed an attacker to exploit XSS by injecting HTML in notes. This is a high severity issue (<code>CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N</code>, 8.7). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1175">CVE-2022-1175</a>.</p>
<p>Thanks <a href="https://hackerone.com/joaxcar">joaxcar</a> for reporting this vulnerability through our HackerOne bug bounty program.</p>
<h2 id=stored-xss-on-multi-word-milestone-reference>Stored XSS on Multi-word milestone reference</h2>
<p>Improper handling of user input in GitLab CE/EE versions 8.3 prior to 14.7.7, 14.8 prior to 14.8.5, and 14.9 prior to 14.9.2 allowed an attacker to exploit a stored XSS by abusing multi-word milestone references in issue descriptions, comments, etc. This is a high severity issue (<code>CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N</code>, 8.7). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1190">CVE-2022-1190</a>.</p>
<p>Thanks <a href="https://hackerone.com/ryhmnlfj">ryhmnlfj</a> for reporting this vulnerability through our HackerOne bug bounty program</p>
<h2 id=denial-of-service-caused-by-a-specially-crafted-rdoc-file>Denial of service caused by a specially crafted RDoc file</h2>
<p>A denial of service vulnerability when rendering RDoc files in GitLab CE/EE versions 10 to 14.7.7, 14.8.0 to 14.8.5, and 14.9.0 to 14.9.2 allows an attacker to crash the GitLab web application with a maliciously crafted RDoc file. This is a medium severity issue (<code>CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H</code>, 6.5). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1185">CVE-2022-1185</a>.</p>
<p>Thanks <a href="https://hackerone.com/vakzz">vakzz</a> for reporting this vulnerability through our HackerOne bug bounty program.</p>
<h2 id=gitlab-pages-access-tokens-can-be-reused-on-multiple-domains>GitLab Pages access tokens can be reused on multiple domains</h2>
<p>Improper authorization in GitLab Pages included with GitLab CE/EE affecting all versions from 11.5 prior to 14.7.7, 14.8 prior to 14.8.5, and 14.9 prior to 14.9.2 allowed an attacker to steal a user's access token on an attacker-controlled private GitLab Pages website and reuse that token on the victim's other private websites. This is a medium severity issue (<code>CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N</code>, 5.3). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1148">CVE-2022-1148</a>.</p>
<p>Thanks <a href="https://hackerone.com/ehhthing">ehhthing</a> for reporting this vulnerability through our HackerOne bug bounty program.</p>
<h2 id=gitlab-pages-uses-default-disabled-server-timeouts-and-a-weak-tcp-keep-alive-timeout>GitLab Pages uses default (disabled) server Timeouts and a weak TCP Keep-Alive timeout</h2>
<p>A lack of appropriate timeouts in GitLab Pages included in GitLab CE/EE all versions prior to 14.7.7, 14.8 prior to 14.8.5, and 14.9 prior to 14.9.2 allows an attacker to cause unlimited resource consumption. This is a medium severity issue (<code>CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L</code>, 5.3). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1121">CVE-2022-1121</a>.</p>
<p>Thanks <a href="https://gitlab.com/feistel">feistel</a> for reporting this vulnerability.</p>
<h2 id=incorrect-include-in-pipeline-definition-exposes-masked-ci-variables-in-ui>Incorrect include in pipeline definition exposes masked CI variables in UI</h2>
<p>Missing filtering in an error message in GitLab CE/EE affecting all versions prior to 14.7.7, 14.8 prior to 14.8.5, and 14.9 prior to 14.9.2 exposed sensitive information when an include directive fails in the CI/CD configuration. This is a medium severity issue (<code>CVSS:3.0/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:N/A:N</code>, 4.8). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1120">CVE-2022-1120</a>.</p>
<p>Thanks <a href="https://hackerone.com/bdrich">bdrich</a> for reporting this vulnerability through our HackerOne bug bounty program.</p>
<h2 id=regular-expression-denial-of-service-in-release-asset-link>Regular expression denial of service in release asset link</h2>
<p>A potential DOS vulnerability was discovered in GitLab CE/EE affecting all versions from 13.1 prior to 14.7.7, 14.8.0 prior to 14.8.5, and 14.9.0 prior to 14.9.2. The api to update an asset as a link from a release had a regex check which caused exponential number of backtracks for certain user supplied values resulting in high CPU usage. This is a medium severity issue (<code>CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L</code>, 4.3). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1100">CVE-2022-1100</a>.</p>
<p>This vulnerability has been discovered internally by the GitLab team.</p>
<h2 id=latest-commit-details-from-private-projects-leaked-to-guest-users-via-merge-requests>Latest Commit details from private projects leaked to guest users via Merge Requests</h2>
<p>Improper access control in GitLab CE/EE since version 10.7 allows a malicious actor to obtain details of the latest commit in a private project via Merge Requests under certain circumstances. This is a medium severity issue (<code>CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N</code>, 4.3). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1193">CVE-2022-1193</a>.</p>
<p>Thanks <a href="https://hackerone.com/albatraoz">albatraoz</a> for reporting this vulnerability through our HackerOne bug bounty program.</p>
<h2 id=cicd-analytics-are-available-even-when-public-pipelines-are-disabled>CI/CD analytics are available even when public pipelines are disabled</h2>
<p>An improper access control vulnerability in GitLab CE/EE affecting all versions from 13.11 prior to 14.7.7, 14.8 prior to 14.8.5, and 14.9 prior to 14.9.2 allows an unauthorized user to access pipeline analytics even when public pipelines are disabled. This is a medium severity issue (<code>CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N</code>, 4.3). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1105">CVE-2022-1105</a>.</p>
<p>This vulnerability has been discovered internally by the GitLab team.</p>
<h2 id=absence-of-limit-for-the-number-of-tags-that-can-be-added-to-a-runner-can-cause-performance-issues>Absence of limit for the number of tags that can be added to a runner can cause performance issues</h2>
<p>Adding a very large number of tags to a runner in GitLab CE/EE affecting all versions prior to 14.7.7, 14.8 prior to 14.8.5, and 14.9 prior to 14.9.2 allows an attacker to impact the performance of GitLab. This is a medium severity issue (<code>CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L</code>, 4.3). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1099">CVE-2022-1099</a>.</p>
<p>This vulnerability has been discovered internally by the GitLab team.</p>
<h2 id=client-dos-through-rendering-crafted-comments>Client DoS through rendering crafted comments</h2>
<p>A potential DoS vulnerability was discovered in Gitlab CE/EE versions 13.7 before 14.7.7, all versions starting from 14.8 before 14.8.5, all versions starting from 14.9 before 14.9.2 allowed an attacker to trigger high CPU usage via a special crafted input added in Issues, Merge requests, Milestones, Snippets, Wiki pages, etc. This is a medium severity issue (<code>CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L</code>, 4.3). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1174">CVE-2022-1174</a>.</p>
<p>Thanks <a href="https://hackerone.com/scaramouche31">scaramouche31</a> for reporting this vulnerability through our HackerOne bug bounty program.</p>
<h2 id=blind-ssrf-through-repository-mirroring>Blind SSRF Through Repository Mirroring</h2>
<p>An issue has been discovered in GitLab CE/EE affecting all versions starting from 12.1 before 14.7.7, all versions starting from 14.8 before 14.8.5, all versions starting from 14.9 before 14.9.2 where a blind SSRF attack through the repository mirroring feature was possible. This is a low severity issue (<code>CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N</code>, 3.7). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1188">CVE-2022-1188</a>.</p>
<p>Thanks <a href="https://hackerone.com/jimeno">jimeno</a> for reporting this vulnerability through our HackerOne bug bounty program.</p>
<h2 id=bypass-of-branch-restriction-in-asana-integration>Bypass of branch restriction in Asana integration</h2>
<p>Incorrect authorization in the Asana integration's branch restriction feature in all versions of GitLab CE/EE starting from version 7.8.0 before 14.7.7, all versions starting from 14.8 before 14.8.5, all versions starting from 14.9 before 14.9.2 makes it possible to close Asana tasks from unrestricted branches. This is a low severity issue (<code>CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:N</code>, 3.1). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0740">CVE-2022-0740</a>.</p>
<p>Thanks <a href="https://hackerone.com/ooooooo_q">ooooooo_q</a> for reporting this vulnerability through our HackerOne bug bounty program.</p>
<h2 id=readable-approval-rules-by-guest-user>Readable approval rules by Guest user</h2>
<p>An issue has been discovered in GitLab CE/EE affecting all versions starting from 12.2 before 14.7.7, all versions starting from 14.8 before 14.8.5, all versions starting from 14.9 before 14.9.2 that allowed for an unauthorised user to read the the approval rules of a private project. This is a low severity issue (<code>CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N</code>, 3.1). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1189">CVE-2022-1189</a>.</p>
<p>This vulnerability has been discovered internally by the GitLab team.</p>
<h2 id=redact-invalidurierror-error-messages>Redact InvalidURIError error messages</h2>
<p>Missing sanitization of logged exception messages in all versions prior to 14.7.7, 14.8 prior to 14.8.5, and 14.9 prior to 14.9.2 of GitLab CE/EE causes potential sensitive values in invalid URLs to be logged. This is a low severity issue (<code>CVSS:3.0/AV:N/AC:H/PR:H/UI:R/S:C/C:L/I:N/A:N</code>, 2.6). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1157">CVE-2022-1157</a>.</p>
<p>This vulnerability has been discovered internally by the GitLab team.</p>
<h2 id=project-import-maps-members-created_by_id-users-based-on-source-user-id>Project import maps members' created_by_id users based on source user ID</h2>
<p>A business logic error in Project Import in GitLab CE/EE versions 14.9 prior to 14.9.2, 14.8 prior to 14.8.5, and 14.0 prior to 14.7.7 under certain conditions caused imported projects to show an incorrect user in the 'Access Granted' column in the project membership pages. This is a low severity issue (<code>CVSS:3.0/AV:N/AC:L/PR:H/UI:R/S:U/C:N/I:L/A:N</code>, 2.4). It is now mitigated in the latest release and is assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1111">CVE-2022-1111</a>.</p>
<p>This vulnerability has been discovered internally by the GitLab team.</p>
<h2 id=update-commonmarker>Update commonmarker</h2>

<p>The version of commonmarker has been updated to <code>0.23.4</code> in order to mitigate security concerns.</p>
<h3 id=versions-affected>Versions affected</h3>
<p>Affects all versions of GitLab CE/EE</p>
<h2 id=update-grafana>Update Grafana</h2>

<p>The version of Grafana has been updated to <code>7.5.15</code> in order to mitigate security concerns.</p>
<h3 id=versions-affected-1>Versions affected</h3>
<p>Affects all versions of GitLab Omnibus</p>
<h2 id=update-mattermost>Update Mattermost</h2>

<p>The version of Mattermost has been updated to <code>6.4.2</code>, <code>6.3.5</code>, and <code>6.2.5</code> in order to mitigate security concerns.</p>
<h3 id=versions-affected-2>Versions affected</h3>
<p>Affects all versions of GitLab CE/EE.</p>
<h2 id=update-swagger>Update Swagger</h2>

<p>The version of Swagger has been updated to <code>4.0.0</code> in order to mitigate security concerns.</p>
<h3 id=versions-affected-3>Versions affected</h3>
<p>Affects all versions of GitLab CE/EE</p>
<h2 id=update-python>Update Python</h2>

<p>The version of Python has been updated to <code>3.8.12</code> in order to mitigate security concerns.</p>
<h3 id=versions-affected-4>Versions affected</h3>
<p>Affects all versions of <a href="https://gitlab.com/gitlab-org/charts/gitlab">GitLab Charts</a>.</p>
<h2 id=update-go-proxyproto>Update go-proxyproto</h2>

<p>The version of go-proxyproto has been updated to <code>0.6.2</code> in order to mitigate security concerns.</p>
<h3 id=versions-affected-5>Versions affected</h3>
<p>Affects all versions of GitLab Pages</p>
<h2 id=update-devise>Update Devise</h2>

<p>The version of devise-two-factor has been updated to <code>4.0.2</code> in order to mitigate security concerns.</p>
<h3 id=versions-affected-6>Versions affected</h3>
<p>Affects all versions of Gitlab CE/EE</p>
<h2 id=non-security-updates>Non-security updates</h2>
<p>14.7.7 and 14.8.5 include a non-security bug fix addressing Merge Request Approval Rules. The bug is not present in 14.9 releases.</p>
<h2 id=updating>Updating</h2>
<p>To update GitLab, see the <a href="/update/">update page</a>.
To update Gitlab Runner, see the <a href="https://docs.gitlab.com/runner/install/linux-repository.html#updating-the-runner">Updating the Runner page</a>.</p>
<h2 id=script-to-identify-users-potentially-impacted-by-cve-2022-1162>Script to identify users potentially impacted by CVE-2022-1162</h2>

<p>GitLab has prepared a script which can be used by self-managed instance admins to identify user accounts potentially impacted by CVE-2022-1162.</p>
<div class=highlight><pre class="highlight ruby"><code><span class="c1"># This script identifies users who may have been impacted by </span>
<span class="c1"># CVE-2022-1162.</span>
<span class="c1"># The list is not exhaustive and may not include attackers who have </span>
<span class="c1"># gained access and modified an account.</span>
<span class="c1">#</span>
<span class="c1"># The START_DATE can be changed to the date a vulnerable version was</span>
<span class="c1"># installed.</span>
<span class="c1">#</span>
<span class="c1"># The result is a CSV printed to STDOUT containing potentially affected</span>
<span class="c1"># users. The columns are:</span>
<span class="c1">#   - User ID (integer)</span>
<span class="c1">#   - Username (string)</span>
<span class="c1">#   - User's email (string)</span>
<span class="c1">#   - Whether the user still has an automatically set password (boolean)</span>
<span class="c1">#</span>
<span class="c1"># We strongly recommend that all GitLab installations be upgraded to</span>
<span class="c1"># 14.9.2, 14.8.5, or 14.7.7 immediately.</span>
<span class="c1"># See: https://about.gitlab.com/releases/2022/03/31/critical-security-release-gitlab-14-9-2-released/</span>
<span class="c1">#</span>
<span class="c1"># To run the script, place this script into a file ie. /tmp/find-impacted-users.rb </span>
<span class="c1"># on your GitLab instance and then run the following command to execute the script:</span>
<span class="c1">#</span>
<span class="c1">#     gitlab-rails runner /tmp/find-impacted-users.rb</span>
<span class="c1">#</span>
<span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="p">.</span><span class="nf">connection</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="s1">'set statement_timeout to 600000'</span><span class="p">)</span>

<span class="no">START_DATE</span> <span class="o">=</span> <span class="no">Time</span><span class="p">.</span><span class="nf">utc</span><span class="p">(</span><span class="mi">2022</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

<span class="n">user_id</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">csv</span> <span class="o">=</span> <span class="no">CSV</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="no">STDOUT</span><span class="p">)</span>
<span class="k">begin</span>
    <span class="n">users</span> <span class="o">=</span> <span class="no">User</span><span class="p">.</span>
        <span class="nf">joins</span><span class="p">(</span><span class="ss">:identities</span><span class="p">).</span>
        <span class="nf">where</span><span class="p">(</span><span class="s1">'users.created_at &gt;= ?'</span><span class="p">,</span> <span class="no">START_DATE</span><span class="p">).</span>
        <span class="nf">where</span><span class="p">(</span><span class="s1">'identities.created_at &gt;= ?'</span><span class="p">,</span> <span class="no">START_DATE</span><span class="p">).</span>
        <span class="nf">where</span><span class="p">(</span><span class="s1">'users.id &gt; ?'</span><span class="p">,</span> <span class="n">user_id</span><span class="p">)</span>
          
    <span class="n">users</span><span class="p">.</span><span class="nf">in_batches</span><span class="p">(</span><span class="ss">of: </span><span class="mi">250</span><span class="p">).</span><span class="nf">each_record</span> <span class="k">do</span> <span class="o">|</span><span class="n">user</span><span class="o">|</span>
      <span class="n">csv</span> <span class="o">&lt;&lt;</span> <span class="p">[</span><span class="n">user</span><span class="p">.</span><span class="nf">id</span><span class="p">,</span> <span class="n">user</span><span class="p">.</span><span class="nf">username</span><span class="p">,</span> <span class="n">user</span><span class="p">.</span><span class="nf">email</span><span class="p">,</span> <span class="n">user</span><span class="p">.</span><span class="nf">password_automatically_set?</span><span class="p">]</span>
      <span class="n">user_id</span> <span class="o">=</span> <span class="n">user</span><span class="p">.</span><span class="nf">id</span>
    <span class="k">end</span>
<span class="k">rescue</span>
    <span class="k">retry</span>  
<span class="k">end</span>

</code></pre></div>
<p>A <code>false</code> value in the <code>user.password_automatically_set?</code> column means that the user had overwritten the random password that was originally set when creating the user via an Omniauth method (e.g. OAuth, LDAP, or SAML). Double-check these accounts to ensure that this change was intentional and not the result of exploitation.</p>
<p>Out of an abundance of caution it is recommended to reset the passwords for all users returned by the script. Users where <code>password_automatically_set?</code> is <code>true</code> will not notice that the password reset happened and can continue logging in using OAuth, LDAP, or SAML. Those where the value is <code>false</code> can also keep logging in using those authentication methods, however the password they had set themselves will not work anymore.</p>
<p>Users created before the installation of GitLab 14.7.0 or after the update to GitLab 14.9.2, 14.8.5, or 14.7.7 are not affected and no actions are required.</p>
<p>GitLab has conducted limited testing to validate this script. As such
this script is provided AS-IS and GitLab makes no warranties of any
kind. GITLAB HEREBY DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED,
INCLUDING, WITHOUT LIMITATION, ALL IMPLIED WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, TITLE, AND
NON-INFRINGEMENT.</p>
<p>After identifying potentially affected user accounts, it is recommended to <a href="https://docs.gitlab.com/ee/security/reset_user_password.html#reset-a-users-password">reset a user's password</a>.</p>
<h2 id=receive-security-release-notifications>Receive Security Release Notifications</h2>
<p>To receive security release blog notifications delivered to your inbox, visit our <a href="https://about.gitlab.com/company/contact/">contact us</a> page.
To receive release notifications via RSS, subscribe to our <a href="https://about.gitlab.com/security-releases.xml">security release RSS feed</a> or our <a href="https://about.gitlab.com/all-releases.xml">RSS feed for all releases</a>.</p>
<div class='panel panel-default twitter-block'>
<a class='twitter-block-link panel-body' href='http://twitter.com/share?text=GitLab+Critical+Security+Release%3A+14.9.2%2C+14.8.5%2C+and+14.7.7&amp;url=https://about.gitlab.com/releases/2022/03/31/critical-security-release-gitlab-14-9-2-released/&amp;hashtags=' rel=nofollow target=_blank title='Tweet!'>
<span class='twitter-text pull-left'>
GitLab Critical Security Release: 14.9.2, 14.8.5, and 14.7.7
</span>
<span class=click-to-tweet>
Click to tweet!
<i class='fab fa-twitter'></i>
</span>
</a>
</div>
</div>
<ul class='tag-list list-unstyled'>
<li class=tag>
<a href="/releases/tags.html#security">security</a>
</li>
</ul>
<div class=social>
<div class='share-butons clearfix'>
<a class='share-btn share-btn-facebook' href='http://www.facebook.com/sharer.php?u=https://about.gitlab.com/releases/2022/03/31/critical-security-release-gitlab-14-9-2-released/' onclick='openSocialLink(this, 500, 400); return false;' target=_blank>
<i class='fab fa-facebook'></i>
<span class=sr-only>
Share on Facebook
</span>
</a>
<a class='share-btn share-btn-twitter' href='http://twitter.com/share?url=https://about.gitlab.com/releases/2022/03/31/critical-security-release-gitlab-14-9-2-released/&amp;text=GitLab Critical Security Release: 14.9.2, 14.8.5, and 14.7.7' onclick='openSocialLink(this, 500, 400); return false;' target=_blank>
<i class='fab fa-twitter'></i>
<span class=sr-only>
Share on Twitter
</span>
</a>
<a class='share-btn share-btn-linkedin' href='https://www.linkedin.com/shareArticle?mini=true&amp;url=https://about.gitlab.com/releases/2022/03/31/critical-security-release-gitlab-14-9-2-released/&amp;title=GitLab Critical Security Release: 14.9.2, 14.8.5, and 14.7.7&amp;summary=&amp;source=' onclick='openSocialLink(this, 500, 400); return false;' target=_blank>
<i class='fab fa-linkedin'></i>
<span class=sr-only>
Share on LinkedIn
</span>
</a>
<a class='share-btn share-btn-hackernews' href='https://news.ycombinator.com/submitlink?u=https://about.gitlab.com/releases/2022/03/31/critical-security-release-gitlab-14-9-2-released/&amp;t=GitLab Critical Security Release: 14.9.2, 14.8.5, and 14.7.7' onclick='openSocialLink(this, 500, 400); return false;' target=_blank>
<i class='fab fa-hacker-news'></i>
<span class=sr-only>
Share on Hacker News
</span>
</a>
</div>
</div>
<nav aria-label='Blog post pager'>
<ul class=pager>
<li class=pull-left>
<a href="/releases/2022/03/24/gitlab-14-7-6-released/" title="GitLab Patch Release: 14.7.6"><i class='fa fa-chevron-left'></i>
<span class=screen-reader-text>Previous Post:</span>
<span class=adjacent_post_title>
GitLab Patch Release: 14.7.6
</span>
</a></li>
<li class=pull-right>
<a href="/releases/2022/04/01/gitlab-14-6-7-released/" title="GitLab Patch Release: 14.6.7"><span class=screen-reader-text>Next Post:</span>
<span class=adjacent_post_title>
GitLab Patch Release: 14.6.7
</span>
<i class='fa fa-chevron-right'></i>
</a></li>
</ul>
</nav>
</div>
<div class='wrapper signup'>
<div class="panel panel-default nl panel-newsletter-signup">
<div class=row>
<div class="col-12 newsletter">
<div class=newsletter-form style="margin: 32px 0">
<span class=newsletter-preamble>
Sign up for GitLab's monthly newsletter
</span>
<script src="//page.gitlab.com/js/forms2/js/forms2.min.js"></script>
<form id=mktoForm_1077 style="display: initial"></form>
<script>

          MktoForms2.setOptions(
          {
            formXDPath : "/rs/194-VVC-221/images/marketo-xdframe-relative.html"
          });
          MktoForms2.loadForm("//page.gitlab.com", "194-VVC-221", 1077, function(form) {
            form.onSuccess(function(values, followUpUrl) {

              dataLayer.push(
              {
                'event' : 'mktoLead', 
                'mktoFormId' : form.getId(),
                'eventCallback' : function()
                {
                  form.getFormElem().hide();
                  document.getElementById('confirmform').style.display = 'block';
                }, 'eventTimeout' : 3000
              });
              return false;
            });
            function getgacid() {
              try {
                var tracker = ga.getAll()[0];
                return tracker.get('clientId');
              } catch (e) {
                return 'n/a';
              }
            }
            form.vals({
              'gacid': getgacid()
            });
          });
        </script>
<div id=confirmform class=confirm-message style="display:none;"><p>Thanks for subscribing!</p></div>
</div>
</div>
</div>
</div>
</div>
<div class=gitlab-trial>
<div class=gitlab-trial__wrapper>
<div class=gitlab-trial__left-side>
<h2>
Take GitLab for a spin
</h2>
<p>
See what your team could do with The DevSecOps Platform.
</p>
<a href="https://gitlab.com/-/trials/new?glm_content=default-saas-trial&amp;glm_source=about.gitlab.com" class="btn cta-btn" data-ga-name="free trial" data-ga-location="try partial">Get free trial</a>
</div>
<div class=gitlab-trial__right-side>
<img src="/images/cta/gitlab-enterprise-team-member-photos.png" alt=""/>
<p>
Have a question? We're here to help.
</p>
<a class=sales-cta href='https://about.gitlab.com/sales/'>
Talk to an expert
</a>
</div>
</div>
</div>
<div style='display: none'>
<a href="https://gitlab.com/-/ide/project/gitlab-com/www-gitlab-com/edit/master/-/sites/uncategorized/source/releases/posts/2022-03-31-critical-security-release-gitlab-14-9-2-released.html.md" id=hidden-web-ide>Edit this page</a>
<a href="https://gitlab.com/gitlab-com/www-gitlab-com/blob/master/sites/uncategorized/source/releases/posts/2022-03-31-critical-security-release-gitlab-14-9-2-released.html.md" id=hidden-page-source>View source</a>
</div>
<footer id=global-footer>
<slp-footer></slp-footer>
</footer>
<script src='/javascripts/be-footer.js?cacheBust=4cf1fb774d1'></script>
<script src="/javascripts/libs/jquery.min.js?cacheBust=4cf1fb774d1"></script>
<script src="/javascripts/libs/jquery-migrate-3.3.0.min.js?cacheBust=4cf1fb774d1"></script>
<script src="/javascripts/libs/bootstrap.min.js?cacheBust=4cf1fb774d1"></script>
<script src="/javascripts/libs/jqBootstrapValidation.js?cacheBust=4cf1fb774d1"></script>
<script src="/javascripts/scripts.js?cacheBust=4cf1fb774d1"></script>
<script>
  //<![CDATA[
    $.ajax({
      url: '//munchkin.marketo.net/munchkin.js',
      dataType: 'script',
      cache: true,
      success: function() {
        Munchkin.init('194-VVC-221');
      }
    });
  //]]>
</script>
<script defer=true src='/javascripts/cbextras.js'></script>
</div>
</body>
</html>
